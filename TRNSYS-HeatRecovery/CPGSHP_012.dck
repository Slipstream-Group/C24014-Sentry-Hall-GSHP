VERSION 17
*******************************************************************************
*** TRNSYS input file (deck) generated by TrnsysStudio
*** on Tuesday, October 22, 2024 at 14:50
*** from TrnsysStudio project: C:\Trnsys17\MyProjects\Sentry Hall GSHP\TRNSYS-HeatRecovery\CPGSHP_012.tpf
*** 
*** If you edit this file, use the File/Import TRNSYS Input File function in 
*** TrnsysStudio to update the project. 
*** 
*** If you have problems, questions or suggestions please contact your local 
*** TRNSYS distributor or mailto:software@cstb.fr 
*** 
*******************************************************************************


*******************************************************************************
*** Units 
*******************************************************************************

*******************************************************************************
*** Control cards
*******************************************************************************
* START, STOP and STEP
CONSTANTS 3
START=0
STOP=final
STEP=timestep
SIMULATION 	 START	 STOP	 STEP	! Start time	End time	Time step
TOLERANCES 0.0001 0.0001			! Integration	 Convergence
LIMITS 30 errorval 30				! Max iterations	Max warnings	Trace limit
DFQ 1					! TRNSYS numerical integration solver method
WIDTH 80				! TRNSYS output file width, number of characters
LIST 					! NOLIST statement
					! MAP statement
SOLVER 0 1 1				! Solver statement	Minimum relaxation factor	Maximum relaxation factor
NAN_CHECK 0				! Nan DEBUG statement
OVERWRITE_CHECK 0			! Overwrite DEBUG statement
TIME_REPORT 0			! disable time report
EQSOLVER 0				! EQUATION SOLVER statement
* User defined CONSTANTS 
Equations 3
final=8760*25
timestep=6/60
errorval=final*(1/timestep)*0.01

* EQUATIONS "Fluid"
* 
EQUATIONS 20
rho_hw = 1000  ! kg/m^3
cp_hw = 4.190  ! kJ/kg.K
rho_chw = 1000  ! kg/m^3
cp_chw = 4.190  ! kJ/kg.K
rho_src = 1000  ! kg/m^3
cp_src = 4.190  ! kJ/kg.K
c_tankloss = 1  ! kJ/hr.m^2.K
k_hw = 2.14  ! kJ/hr.m.K
v_hw = 3.21  ! kg/m.hr
k_chw = 2.14  ! kJ/hr.m.K
v_chw = 3.21  ! kg/m.hr
galperton = 8  ! gallons per ton buffer storage, 3 to 12 is typical
vol_chw1 = q_coolmax * galperton / (12660.670231 * 264.17)  ! m^3
vol_hw1 = q_heatmax * galperton / (12660.670231 * 264.17)  ! m^3
vol_chw2 = 3 * 1.2 * max(m_pumpCHWmax, m_chwmax) * timestep / rho_chw ! m^3, a volume over 3 times greater than that moved in a timestep
vol_hw2 = 3 * 1.2 * max(m_pumpHWmax, m_hwmax) * timestep / rho_hw ! m^3, a volume over 3 times greater than that moved in a timestep
vol_chw = max(vol_chw1, vol_chw2)
vol_hw = max(vol_hw1, vol_hw2)
high_chw = vol_chw * 3  ! m, a calculation for the height of the tank based on the volume
high_hw = vol_hw * 3  ! m, a calculation for the height of the tank based on the volume
*$UNIT_NAME Fluid
*$LAYER Main
*$POSITION 75 305

*------------------------------------------------------------------------------


* EQUATIONS "CalcBHE"
* 
EQUATIONS 34
sim_years = max(int(final / 8760), 1)
plotspersim = sim_years
n_bhe = max(int(Length_GHX/(depth*3.28))+1 , 1) ! max(int(q_cool_stg2 * n_modules / (12660 * 5)), 1)  ! 20  ! number of borehole heat exchangers
enable_bhe = gt(Length_GHX, 0)
spacing = 20/3.28  ! ft --> m, the spacing between bore centerlines
depth = 500 / 3.28 ! ft --> m, the depth drilled to
pattern = 0.5642   ! 0.5642 = square, 0.525 = hexagonal
stgvol = 3.14159 * n_bhe * depth * (pattern * spacing) * (pattern * spacing)   ! m^3
brfr = 8 * 60 * rho_src / 264.17   ! gpm --> kg/hr, the design flow rate per bore
dP_bhe = (1.6) * 2.98608 * 3.280839895 / 100 ! (ftH2O/100ft) --> kPa/m, assume 8 gpm/bhe and 1-1/4 HDPE
k_soil = Ground_Conduct * 1.7295772056 * 3.6  ! Btu/hr.ft.F --> kJ/hr.m.K
k_fill = 0.85 * 1.7295772056 * 3.6  ! Btu/hr.ft.F --> kJ/hr.m.K
cp_soil = 1.0   ! leave as one
rho_soil = k_soil * 258.334/(Ground_Diff)/cp_soil  ! Insert Thermal Diffusivity - Alpha [ft^2/day] into parenthesis - kg/m^3
rhocp_soil = cp_soil * rho_soil
t_ground = (Ground_Temp - 32)*5/9  ! F --> C
rad_bore = 6.0 / (2 * 39.37007874)  ! in --> m
sdr = 11   !  hdpe pipe diameter ratio
do_pipe = 1.660 / 39.37007874  ! in --> m
di_pipe = do_pipe * (sdr-2) / sdr    ! m
ro_pipe = do_pipe / 2    ! m
ri_pipe = di_pipe / 2   ! m
width_gap = (2 * rad_bore - 2 * do_pipe) / 3    ! m
half_gap = 0.010
shank_spacing = ro_pipe + half_gap   ! m
length_hdpe = depth * 2 + spacing * (n_bhe**0.5) + 40/3.28   ! m
di_hdpe = 2 * (n_bhe * ri_pipe * ri_pipe)**0.5  ! m
sdr_hz = 15.5   !  hdpe pipe diameter ratio, horizontal pipes
do_hzpipe = 2.875 / 39.37007874  ! in --> m
di_hzpipe = do_hzpipe * (sdr_hz-2) / sdr_hz    ! m
length_hzpipe = (n_bhe*spacing+20/3.28)
depth_hzpipe = 4 / 3.28 ! ft --> m, the depth of buried horizontal pipe
do_case = 5 * do_hzpipe
space_hz = 2 * do_hzpipe
*$UNIT_NAME CalcBHE
*$LAYER Main
*$POSITION 125 328

*------------------------------------------------------------------------------


* EQUATIONS "CalcFlow"
* 
EQUATIONS 55
q_coolmax = Peak_CHW_MBH * 1055.0558526  ! MBH --> kJ/hr, the max load, set by user
q_heatmax = Peak_HW_MBH * 1055.0558526  ! MBH --> kJ/hr, the max load, set by user
q_cool_stg2 = 30.7 * 12660.670231  ! tons --> kJ/hr, the rated cooling capacity of one module
q_cool_stg1 = q_cool_stg2 / 2
p_cool_stg2 = 22.6 * 3600  ! kW --> kJ/hr, the rated cooling power of one module
p_cool_stg1 = p_cool_stg2 / 2
q_heat_stg2 = 413.6 * 1055.0558526  ! MBH --> kJ/hr, the rated heating capacity of one module
q_heat_stg1 = q_heat_stg2 / 2
p_heat_stg2 = 27.0 * 3600  ! kW --> kJ/hr, the rated heating power of one module
p_heat_stg1 = p_heat_stg2 / 2
percent_hybrid = Hybrid_Percent ! base 100
n_modules = int((1 - percent_hybrid/100) * max(q_coolmax / q_cool_stg2, q_heatmax / q_heat_stg2) + 1)  ! the total number of HP modules, allow arbitrary reductions to study hybrid systems
dT_cool = 10 * 5/9  ! dF --> dC, the HW system design delta T
dT_heat = 15 * 5/9  ! dF --> dC, the CHW system design delta T
dP_cool = 150 * 2.98608  ! ftH2O --> kPa, the CHW system design pressure drop, don't count the heat pumps
dP_heat = 175 * 2.98608  ! ftH2O --> kPa, the HW system design pressure drop, don't count the heat pumps
sig_loadmin = 0.10  ! the minimum speed fraction for the load pumps
effloadpump = 0.65  ! the efficiency of the load pumps
m_chwmax = q_coolmax / (cp_chw * dT_cool)  ! kg/hr, the maximum mass flow rate through the load pump
m_hwmax = q_heatmax / (cp_hw * dT_heat)  ! kg/hr, the maximum mass flow rate through the load pump
p_chwmax = m_chwmax * dP_cool / (rho_chw * effloadpump)  ! kJ/hr
p_hwmax = m_hwmax * dP_heat / (rho_hw * effloadpump)  ! kJ/hr
m_loadcool = q_cool_stg2 / (cp_chw * dT_cool)  ! kg/hr, flow through one module
m_loadheat = q_heat_stg2 / (cp_hw * dT_heat)  ! kg/hr, flow through one module
m_source = m_loadcool  ! kg/hr, flow through one module
m_vpumpCmax = n_modules * m_loadcool
m_vpumpChalf = m_vpumpCmax / 2
m_vpumpHmax = n_modules * m_loadheat
m_vpumpHhalf = m_vpumpHmax / 2
m_vpumpSmax = n_modules * m_source
m_vpumpShalf = m_vpumpSmax / 2
m_pumpCHWmax = max(m_vpumpCmax, m_chwmax)
m_pumpHWmax = max(m_vpumpHmax, m_hwmax)
m_pumpSRCmax = max(max(m_vpumpSmax, m_chwmax), m_hwmax)
dP_HPchw = 14 * 2.98608  ! ftH2O --> kPa, the design pressure drop through the heat pumps
dP_HPhw = 8 * 2.98608  ! ftH2O --> kPa, the design pressure drop through the heat pumps
dP_HPsrc = 16 * 2.98608  ! ftH2O --> kPa, the design pressure drop through the heat pumps
dP_HX = 0 * 2.98608  ! ftH2O --> kPa, the design pressure drop through the HX, enter zero if direct connect
effHPpump = 0.65
p_pumpCHWmax = m_pumpCHWmax * dP_HPchw / (rho_chw * effHPpump)  ! kJ/hr
p_pumpCHWfree = m_pumpCHWmax * dP_HX / (rho_chw * effHPpump)  ! kJ/hr
p_pumpHWmax = m_pumpHWmax * dP_HPhw / (rho_hw * effHPpump)  ! kJ/hr
p_pumpHWfree = m_pumpHWmax * dP_HX / (rho_hw * effHPpump)  ! kJ/hr
p_pumpSRCmax = m_pumpSRCmax * dP_HPsrc / (rho_src * effHPpump)  ! kJ/hr
p_pumpSRCfree = m_pumpSRCmax * dP_HX / (rho_src * effHPpump)  ! kJ/hr
lps_loadcool = m_loadcool * 1000 / (3600 * rho_chw)  ! kg/hr --> liters per second
lps_loadheat = m_loadheat * 1000 / (3600 * rho_chw)  ! kg/hr --> liters per second
lps_source = m_source * 1000 / (3600 * rho_chw)  ! kg/hr --> liters per second
lps_halfcool = lps_loadcool / 2
lps_halfheat = lps_loadheat / 2
lps_halfsource = lps_source / 2
di_hppipe = 8 / 39.37007874  ! in --> m
area_hppipe = 3.1416 * di_hppipe * di_hppipe / 4  ! m^2
vol_src = 2.1 * m_pumpSRCmax * timestep / rho_src  ! m^3, a volume greater than the one changed in one timestep
length_hppipe = max(vol_src / area_hppipe, 10)  ! m
*$UNIT_NAME CalcFlow
*$LAYER Main
*$POSITION 184 351

*------------------------------------------------------------------------------


* Model "ToaReset" (Type 1250)
* 

UNIT 86 TYPE 1250	 ToaReset
*$UNIT_NAME ToaReset
*$MODEL .\Controllers Library (TESS)\Outside Air Reset Control\Type1250.tmf
*$POSITION 137 138
*$LAYER Main # 
PARAMETERS 11
2		! 1 Number of controls
1		! 2 Mode-1
-23		! 3 Low ambient temperature condition (T_Amb_L)-1
t_hwmax		! 4 Low ambient setpoint (T_Set_L)-1
13		! 5 High ambient temperature condition (T_Amb_H)-1
t_hwmin		! 6 High ambient setpoint (T_Set_H)-1
2		! 7 Mode-2
18		! 8 Low ambient temperature condition (T_Amb_L)-2
t_chwmax		! 9 Low ambient setpoint (T_Set_L)-2
38		! 10 High ambient temperature condition (T_Amb_H)-2
t_chwmin		! 11 High ambient setpoint (T_Set_H)-2
INPUTS 2
87,4 		! HourlyLoads:Output 4 ->Ambient temperature-1
87,4 		! HourlyLoads:Output 4 ->Ambient temperature-2
*** INITIAL INPUT VALUES
10 10 
*------------------------------------------------------------------------------

* Model "ResetHW" (Type 14)
* 

UNIT 65 TYPE 14	 ResetHW
*$UNIT_NAME ResetHW
*$MODEL .\Utility\Forcing Functions\Temperature\Type14e.tmf
*$POSITION 135 246
*$LAYER Main # 
PARAMETERS 12
0		! 1 Initial value of time
t_hwmax		! 2 Initial temperature
1460		! 3 Time at point-1
t_hwmax		! 4 Temperature at point -1
2920		! 5 Time at point-2
t_hwmin		! 6 Temperature at point -2
5840		! 7 Time at point-3
t_hwmin		! 8 Temperature at point -3
7300		! 9 Time at point-4
t_hwmax		! 10 Temperature at point -4
8760		! 11 Time at point-5
t_hwmax		! 12 Temperature at point -5
*------------------------------------------------------------------------------

* Model "ResetCHW" (Type 14)
* 

UNIT 63 TYPE 14	 ResetCHW
*$UNIT_NAME ResetCHW
*$MODEL .\Utility\Forcing Functions\Temperature\Type14e.tmf
*$POSITION 137 364
*$LAYER Main # 
PARAMETERS 12
0		! 1 Initial value of time
t_chwmax		! 2 Initial temperature
1460		! 3 Time at point-1
t_chwmax		! 4 Temperature at point -1
2920		! 5 Time at point-2
t_chwmin		! 6 Temperature at point -2
5840		! 7 Time at point-3
t_chwmin		! 8 Temperature at point -3
7300		! 9 Time at point-4
t_chwmax		! 10 Temperature at point -4
8760		! 11 Time at point-5
t_chwmax		! 12 Temperature at point -5
*------------------------------------------------------------------------------

* EQUATIONS "CalcTempCtrl"
* 
EQUATIONS 19
t_hwmax = (135 - 32) * 5/9  ! F --> C, used to generate the HW reset schedule
t_hwmin = (100 - 32) * 5/9  ! F --> C, used to generate the HW reset schedule
t_chwmax = (54 - 32) * 5/9  ! F --> C, used to generate the CHW reset schedule
t_chwmin = (44 - 32) * 5/9  ! F --> C, used to generate the CHW reset schedule
dt_ctrl = 4 * 5/9  ! dF --> dC, the temperature difference for proportional control
dt_ctrlfree = 5 * 5/9  ! dF --> dC, the temperature difference for economizing
t_freeheatset = [86,1] - dt_ctrl/2
t_hwtankhigh = [86,1] + 2*dt_ctrl
t_hwtanklow = [86,1] - 2*dt_ctrl
t_boilerset = t_hwtanklow - dt_ctrl
t_freecoolset = [86,3] + dt_ctrl/2
t_chwtankhigh = [86,3] + 2*dt_ctrl
t_chwtanklow = [86,3] - 2*dt_ctrl
t_chillerset = t_chwtankhigh + dt_ctrl
t_gxtoohigh = (100 - 32) * 5/9  ! F --> C, used to lock out HP cooling
t_gxtoolow = (32 - 32) * 5/9  ! F --> C, used to lock out HP heating
t_bhepumphigh = (75 - 32) * 5/9  ! F --> C, run the GX pump above this temp
t_bhepumplow = (45 - 32) * 5/9  ! F --> C, run the GX pump below this temp
lockout_econ = 0.1
*$UNIT_NAME CalcTempCtrl
*$LAYER Main
*$POSITION 368 245

*------------------------------------------------------------------------------


* Model "Average" (Type 939)
* 

UNIT 85 TYPE 939	 Average
*$UNIT_NAME Average
*$MODEL .\Utility Library (TESS)\Running Totals and Averages\Type939.tmf
*$POSITION 134 468
*$LAYER Main # 
*$# RUNNING TOTALS AND AVERAGES
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
PARAMETERS 3
1		! 1 Number of inputs to watch
2		! 2 Time period
t_ground		! 3 Average value for input
INPUTS 1
40,1 		! vPumpS6:Outlet fluid temperature ->Input value
*** INITIAL INPUT VALUES
0. 
*------------------------------------------------------------------------------

* Model "astat_freeheat" (Type 1503)
* 

UNIT 67 TYPE 1503	 astat_freeheat
*$UNIT_NAME astat_freeheat
*$MODEL .\Controllers Library (TESS)\Aquastats\Cooling Mode\Type1503.tmf
*$POSITION 532 329
*$LAYER Main # 
PARAMETERS 4
1		! 1 Number of cooling stages
5		! 2 # oscillations permitted
dt_ctrlfree		! 3 Temperature dead band
0		! 4 Number of stage exceptions
INPUTS 3
85,2 		! Average:Running average ->Fluid temperature
lockout_econ		! CalcTempCtrl:lockout_econ ->Lockout signal
t_freeheatset		! CalcTempCtrl:t_freeheatset ->Setpoint temperature for stage
*** INITIAL INPUT VALUES
10 0 40 
*------------------------------------------------------------------------------

* Model "astat_freecool" (Type 1502)
* 

UNIT 68 TYPE 1502	 astat_freecool
*$UNIT_NAME astat_freecool
*$MODEL .\Controllers Library (TESS)\Aquastats\Heating Mode\Type1502.tmf
*$POSITION 532 417
*$LAYER Main # 
PARAMETERS 4
1		! 1 Number of heating stages
5		! 2 # oscillations permitted
dt_ctrlfree		! 3 Temperature dead band
0		! 4 Number of stage exceptions
INPUTS 3
85,2 		! Average:Running average ->Fluid temperature
lockout_econ		! CalcTempCtrl:lockout_econ ->Lockout signal
t_freecoolset		! CalcTempCtrl:t_freecoolset ->Setpoint temperature for stage
*** INITIAL INPUT VALUES
10 0 0 
*------------------------------------------------------------------------------

* Model "astat_shed_toolow" (Type 1502)
* 

UNIT 70 TYPE 1502	 astat_shed_toolow
*$UNIT_NAME astat_shed_toolow
*$MODEL .\Controllers Library (TESS)\Aquastats\Heating Mode\Type1502.tmf
*$POSITION 532 599
*$LAYER Main # 
PARAMETERS 4
1		! 1 Number of heating stages
5		! 2 # oscillations permitted
dt_ctrl		! 3 Temperature dead band
0		! 4 Number of stage exceptions
INPUTS 3
85,2 		! Average:Running average ->Fluid temperature
0,0		! [unconnected] Lockout signal
t_gxtoolow		! CalcTempCtrl:t_gxtoolow ->Setpoint temperature for stage
*** INITIAL INPUT VALUES
10 0 0 
*------------------------------------------------------------------------------

* Model "astat_shed_toohigh" (Type 1503)
* 

UNIT 69 TYPE 1503	 astat_shed_toohigh
*$UNIT_NAME astat_shed_toohigh
*$MODEL .\Controllers Library (TESS)\Aquastats\Cooling Mode\Type1503.tmf
*$POSITION 532 511
*$LAYER Main # 
PARAMETERS 4
1		! 1 Number of cooling stages
5		! 2 # oscillations permitted
dt_ctrl		! 3 Temperature dead band
0		! 4 Number of stage exceptions
INPUTS 3
85,2 		! Average:Running average ->Fluid temperature
0,0		! [unconnected] Lockout signal
t_gxtoohigh		! CalcTempCtrl:t_gxtoohigh ->Setpoint temperature for stage
*** INITIAL INPUT VALUES
10 0 40 
*------------------------------------------------------------------------------

* Model "Prop_ctrl" (Type 1669)
* 

UNIT 64 TYPE 1669	 Prop_ctrl
*$UNIT_NAME Prop_ctrl
*$MODEL .\Controllers Library (TESS)\Proportional Controller\Type1669.tmf
*$POSITION 526 245
*$LAYER Main # 
PARAMETERS 5
2		! 1 Number of signals
maxrate		! 2 Maximum rate of increase-1
maxrate		! 3 Maximum rate of decrease-1
maxrate		! 4 Maximum rate of increase-2
maxrate		! 5 Maximum rate of decrease-2
INPUTS 6
t_hwtankhigh		! CalcTempCtrl:t_hwtankhigh ->Upper set point value-1
t_hwtanklow		! CalcTempCtrl:t_hwtanklow ->Lower set point value-1
20,18 		! Tank_HW:Tank nodal temperature-1 ->Input value-1
t_chwtankhigh		! CalcTempCtrl:t_chwtankhigh ->Upper set point value-2
t_chwtanklow		! CalcTempCtrl:t_chwtanklow ->Lower set point value-2
21,20 		! Tank_CHW:Tank nodal temperature-3 ->Input value-2
*** INITIAL INPUT VALUES
t_hwtankhigh t_hwtanklow t_hwmax t_chwtankhigh t_chwtanklow t_chwmax

*------------------------------------------------------------------------------

* Model "Delay" (Type 661)
* 

UNIT 84 TYPE 661	 Delay
*$UNIT_NAME Delay
*$MODEL .\Controllers Library (TESS)\Delayed Inputs\Type661.tmf
*$POSITION 634 249
*$LAYER Main # 
*$# The stickiness is set by the number of timesteps and not based on the number of hours.
PARAMETERS 5
2		! 1 Number of inputs
stepdelay		! 2 # of timesteps to hold value-1
0.0		! 3 Initial function value-1
stepdelay		! 4 # of timesteps to hold value-2
0.0		! 5 Initial function value-2
INPUTS 2
64,1 		! Prop_ctrl:Control signal-1 ->Input value-1
64,2 		! Prop_ctrl:Control signal-2 ->Input value-2
*** INITIAL INPUT VALUES
0.0 0.0 
*------------------------------------------------------------------------------

* EQUATIONS "CalcHPctrl"
* 
EQUATIONS 50
q_cool = abs([87,2])  ! kJ/hr, from data file
q_heat = abs([87,3])  ! kJ/hr, from data file
q_heat_neg = 0 - q_heat  ! kJ/hr, negative value
m_chw = q_cool / (cp_chw * dT_cool)  ! kg/hr, the desired mass flow rate
m_hw = q_heat / (cp_hw * dT_heat)  ! kg/hr, the desired mass flow rate
sig_phwload = min(max(m_hw / m_hwmax, sig_loadmin), 1)
sig_pchwload = min(max(m_chw / m_chwmax, sig_loadmin), 1)
sig_correct_hw = 0 - 2 * ([84,1] - 0.5)
sig_correct_chw = 2 * ([84,2] - 0.5)
gain_hw = 3  ! a control value, tuned manually
gain_chw = 3  ! a control value, tuned manually
maxrate = 1  ! a control value, tuned manually
stepdelay = min(max(int(0.5 / timestep), 1), 25)
freeheat = [67,1] * enable_bhe
freecool = [68,1] * enable_bhe
hpheatok = (1 - [70,1]) * (1 - freeheat) * enable_bhe  ! lockout heating HPs if GX temp too high or if economizing or if geo disabled
hpcoolok = (1 - [69,1]) * (1 - freecool) * enable_bhe  ! lockoutcooling HPs if GX temp too low or if economizing or if geo disabled
mods_heat = max((q_heat / q_heat_stg2) + gain_hw * sig_correct_hw + 0.5, 0)  ! feed forward control logic, the fractional number of modules desired
mods_cool = max((q_cool / q_cool_stg2) + gain_chw * sig_correct_chw + 0.5, 0)  ! feed forward control logic, the fractional number of modules desired
limit_heat = min(mods_heat, n_modules)
limit_cool = min(mods_cool, n_modules)
round_nheat = int(2 * limit_heat) / 2  ! round to nearest 0.5
round_ncool = int(2 * limit_cool) / 2  ! round to nearest 0.5
round_ndhr = min(round_nheat, round_ncool)  ! number in heat recovery
remain_heat = hpheatok * max(round_nheat - round_ndhr, 0)  ! number in HP heat mode
remain_cool = hpcoolok * max(round_ncool - round_ndhr, 0)  ! number in HP cool mode
n_dhr_2nd = int(round_ndhr)
n_dhr_1st = 2 * (round_ndhr - n_dhr_2nd)
n_heat_2nd = int(remain_heat)
n_heat_1st = 2 * (remain_heat - n_heat_2nd)
n_cool_2nd = int(remain_cool)
n_cool_1st = 2 * (remain_cool - n_cool_2nd)
n_total = n_dhr_1st + n_dhr_2nd + n_heat_1st + n_heat_2nd + n_cool_1st + n_cool_2nd
nosrcflow = 1 - gt(n_heat_1st + n_heat_2nd + n_cool_1st + n_cool_2nd, 0)
sig_vpumpS1 = freeheat * min(m_hw / m_hwmax, 1)
sig_vpumpS2 = min(n_heat_1st * m_source / m_vpumpSmax, 1)
sig_vpumpS3 = min(n_heat_2nd * m_source / m_vpumpSmax, 1)
sig_vpumpS4 = min(n_cool_1st * m_source / m_vpumpSmax, 1)
sig_vpumpS5 = min(n_cool_2nd * m_source / m_vpumpSmax, 1)
sig_vpumpS6 = max(freecool * min(m_chw / m_chwmax, 1), 0.05 * nosrcflow * enable_bhe)
sig_vpumpH1 = freeheat * min(m_hw / m_hwmax, 1)
sig_vpumpH2 = min(n_heat_1st * m_loadheat / m_vpumpHmax, 1)
sig_vpumpH3 = min(n_heat_2nd * m_loadheat / m_vpumpHmax, 1)
sig_vpumpH4 = min(n_dhr_1st * m_loadheat / m_vpumpHmax, 1)
sig_vpumpH5 = min(n_dhr_2nd * m_loadheat / m_vpumpHmax, 1)
sig_vpumpC1 = min(n_cool_1st * m_loadcool / m_vpumpCmax, 1)
sig_vpumpC2 = min(n_cool_2nd * m_loadcool / m_vpumpCmax, 1)
sig_vpumpC3 = freecool * min(m_chw / m_chwmax, 1)
sig_vpumpC4 = min(n_dhr_1st * m_loadcool / m_vpumpCmax, 1)
sig_vpumpC5 = min(n_dhr_2nd * m_loadcool / m_vpumpCmax, 1)
*$UNIT_NAME CalcHPctrl
*$LAYER Main
*$POSITION 742 245

*------------------------------------------------------------------------------


* Model "Tank_HW" (Type 534)
* 

UNIT 20 TYPE 534	 Tank_HW
*$UNIT_NAME Tank_HW
*$MODEL .\Storage Tank Library (TESS)\Cylindrical Storage Tank\Vertical Cylinder\Version without Plug-In\No HXs\Type534-NoHX.tmf
*$POSITION 1147 180
*$LAYER Main # 
*$# CYLINDRICAL STORAGE TANK
PARAMETERS 28
-1		! 1 LU for data file
3		! 2 Number of tank nodes
2		! 3 Number of ports
0		! 4 Number of immersed heat exchangers
0		! 5 Number of miscellaneous heat flows
vol_hw		! 6 Tank volume
high_hw		! 7 Tank height
0		! 8 Tank fluid
cp_hw		! 9 Fluid specific heat
rho_hw		! 10 Fluid density
k_hw		! 11 Fluid thermal conductivity
v_hw		! 12 Fluid viscosity
0.00026		! 13 Fluid thermal expansion coefficient
c_tankloss		! 14 Top loss coefficient
c_tankloss		! 15 Edge loss coefficient for node-1
c_tankloss		! 16 Edge loss coefficient for node-2
c_tankloss		! 17 Edge loss coefficient for node-3
c_tankloss		! 18 Bottom loss coefficient
0		! 19 Additional thermal conductivity
1		! 20 Inlet flow mode-1
3		! 21 Entry node-1
1		! 22 Exit node-1
1		! 23 Inlet flow mode-2
1		! 24 Entry node-2
3		! 25 Exit node-2
0		! 26 Flue loss coefficient for node-1
0		! 27 Flue loss coefficient for node-2
0		! 28 Flue loss coefficient for node-3
INPUTS 14
18,1 		! LoadHW:Outlet temperature ->Inlet temperature for port-1
18,2 		! LoadHW:Outlet flow rate ->Inlet flow rate for port-1
55,1 		! PumpHW:Outlet fluid temperature ->Inlet temperature for port-2
55,2 		! PumpHW:Outlet flow rate ->Inlet flow rate for port-2
0,0		! [unconnected] Top loss temperature
0,0		! [unconnected] Edge loss temperature for node-1
0,0		! [unconnected] Edge loss temperature for node-2
0,0		! [unconnected] Edge loss temperature for node-3
0,0		! [unconnected] Bottom loss temperature
0,0		! [unconnected] Gas flue temperature
0,0		! [unconnected] Inversion mixing flow rate
0,0		! [unconnected] Auxiliary heat input for node-1
0,0		! [unconnected] Auxiliary heat input for node-2
0,0		! [unconnected] Auxiliary heat input for node-3
*** INITIAL INPUT VALUES
10 0.0 10 0.0 20.0 20.0 20.0 20.0 20.0 20.0 -100 0.0 0.0 0.0 
DERIVATIVES 3
t_hwmax		! 1 Initial Tank Temperature-1
t_hwmax		! 2 Initial Tank Temperature-2
t_hwmax		! 3 Initial Tank Temperature-3
*------------------------------------------------------------------------------

* Model "PumpHWload" (Type 110)
* 

UNIT 24 TYPE 110	 PumpHWload
*$UNIT_NAME PumpHWload
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 1300 151
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 8
m_hwmax		! 1 Rated flow rate
cp_hw		! 2 Fluid specific heat
p_hwmax		! 3 Rated power
0.0		! 4 Motor heat loss fraction
3		! 5 Number of power coefficients
0		! 6 Power coefficient-1
0.3		! 7 Power coefficient-2
0.7		! 8 Power coefficient-3
INPUTS 5
20,1 		! Tank_HW:Temperature at outlet-1 ->Inlet fluid temperature
20,2 		! Tank_HW:Flow rate at outlet-1 ->Inlet fluid flow rate
sig_phwload		! CalcHPctrl:sig_phwload ->Control signal
effloadpump		! [equation] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
t_hwmax 0.0 0 effloadpump 0.95 
*------------------------------------------------------------------------------

* Model "Boiler" (Type 6)
* 

UNIT 11 TYPE 6	 Boiler
*$UNIT_NAME Boiler
*$MODEL .\HVAC\Auxiliary Heaters\Type6.tmf
*$POSITION 1420 151
*$LAYER Water Loop # 
PARAMETERS 4
q_heatmax		! 1 Maximum heating rate
cp_hw		! 2 Specific heat of fluid
0.0		! 3 Overall loss coefficient for heater during operation
0.93		! 4 Efficiency of auxiliary heater
INPUTS 5
24,1 		! PumpHWload:Outlet fluid temperature ->Inlet fluid temperature
24,2 		! PumpHWload:Outlet flow rate ->Fluid mass flow rate
0,0		! [unconnected] Control Function
t_boilerset		! CalcTempCtrl:t_boilerset ->Set point temperature
0,0		! [unconnected] Temperature of surroundings
*** INITIAL INPUT VALUES
t_hwmax 0 1 t_boilerset 20.0 
*------------------------------------------------------------------------------

* Model "LoadHW" (Type 682)
* 

UNIT 18 TYPE 682	 LoadHW
*$UNIT_NAME LoadHW
*$MODEL .\Loads and Structures (TESS)\Flowstream Loads\Other Fluids\Type682.tmf
*$POSITION 1525 151
*$LAYER Main # 
PARAMETERS 1
cp_hw		! 1 Fluid specific heat
INPUTS 5
11,1 		! Boiler:Outlet fluid temperature ->Inlet temperature
11,2 		! Boiler:Outlet fluid flow rate ->Inlet flow rate
q_heat_neg		! CalcHPctrl:q_heat_neg ->Load
0,0		! [unconnected] Minimum Heating Temperature
0,0		! [unconnected] Maximum Cooling Temperature
*** INITIAL INPUT VALUES
t_hwmax 0 0.0 -999 999 
*------------------------------------------------------------------------------

* Model "Tank_CHW" (Type 534)
* 

UNIT 21 TYPE 534	 Tank_CHW
*$UNIT_NAME Tank_CHW
*$MODEL .\Storage Tank Library (TESS)\Cylindrical Storage Tank\Vertical Cylinder\Version without Plug-In\No HXs\Type534-NoHX.tmf
*$POSITION 1147 636
*$LAYER Main # 
*$# CYLINDRICAL STORAGE TANK
PARAMETERS 28
-1		! 1 LU for data file
3		! 2 Number of tank nodes
2		! 3 Number of ports
0		! 4 Number of immersed heat exchangers
0		! 5 Number of miscellaneous heat flows
vol_chw		! 6 Tank volume
high_chw		! 7 Tank height
0		! 8 Tank fluid
cp_chw		! 9 Fluid specific heat
rho_chw		! 10 Fluid density
k_chw		! 11 Fluid thermal conductivity
v_chw		! 12 Fluid viscosity
0.00026		! 13 Fluid thermal expansion coefficient
c_tankloss		! 14 Top loss coefficient
c_tankloss		! 15 Edge loss coefficient for node-1
c_tankloss		! 16 Edge loss coefficient for node-2
c_tankloss		! 17 Edge loss coefficient for node-3
c_tankloss		! 18 Bottom loss coefficient
0		! 19 Additional thermal conductivity
1		! 20 Inlet flow mode-1
1		! 21 Entry node-1
3		! 22 Exit node-1
1		! 23 Inlet flow mode-2
3		! 24 Entry node-2
1		! 25 Exit node-2
0		! 26 Flue loss coefficient for node-1
0		! 27 Flue loss coefficient for node-2
0		! 28 Flue loss coefficient for node-3
INPUTS 14
19,1 		! LoadCHW:Outlet temperature ->Inlet temperature for port-1
19,2 		! LoadCHW:Outlet flow rate ->Inlet flow rate for port-1
54,1 		! PumpCHW:Outlet fluid temperature ->Inlet temperature for port-2
54,2 		! PumpCHW:Outlet flow rate ->Inlet flow rate for port-2
0,0		! [unconnected] Top loss temperature
0,0		! [unconnected] Edge loss temperature for node-1
0,0		! [unconnected] Edge loss temperature for node-2
0,0		! [unconnected] Edge loss temperature for node-3
0,0		! [unconnected] Bottom loss temperature
0,0		! [unconnected] Gas flue temperature
0,0		! [unconnected] Inversion mixing flow rate
0,0		! [unconnected] Auxiliary heat input for node-1
0,0		! [unconnected] Auxiliary heat input for node-2
0,0		! [unconnected] Auxiliary heat input for node-3
*** INITIAL INPUT VALUES
10 0.0 10 0.0 20.0 20.0 20.0 20.0 20.0 20.0 -100 0.0 0.0 0.0 
DERIVATIVES 3
t_chwmax		! 1 Initial Tank Temperature-1
t_chwmax		! 2 Initial Tank Temperature-2
t_chwmax		! 3 Initial Tank Temperature-3
*------------------------------------------------------------------------------

* Model "PumpCHWload" (Type 110)
* 

UNIT 25 TYPE 110	 PumpCHWload
*$UNIT_NAME PumpCHWload
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 1300 659
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 8
m_chwmax		! 1 Rated flow rate
cp_chw		! 2 Fluid specific heat
p_chwmax		! 3 Rated power
0.0		! 4 Motor heat loss fraction
3		! 5 Number of power coefficients
0		! 6 Power coefficient-1
0.3		! 7 Power coefficient-2
0.7		! 8 Power coefficient-3
INPUTS 5
21,1 		! Tank_CHW:Temperature at outlet-1 ->Inlet fluid temperature
21,2 		! Tank_CHW:Flow rate at outlet-1 ->Inlet fluid flow rate
sig_pchwload		! CalcHPctrl:sig_pchwload ->Control signal
effloadpump		! [equation] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
t_chwmax 0.0 0 effloadpump 0.95 
*------------------------------------------------------------------------------

* Model "Chiller" (Type 655)
* 

UNIT 58 TYPE 655	 Chiller
*$UNIT_NAME Chiller
*$MODEL .\HVAC Library (TESS)\Chillers\Air-Cooled Chiller\Type655.tmf
*$POSITION 1414 660
*$LAYER Main # 
*$# AIR-COOLED CHILLER
PARAMETERS 8
q_coolmax		! 1 Rated capacity
3.0		! 2 Rated C.O.P.
55		! 3 Logical unit for performance data
56		! 4 Logical unit for PLR data file
cp_chw		! 5 Fluid specific heat
5		! 6 Number of ambient temperatures
6		! 7 Number of CHW set points
5		! 8 Number of part load ratios
INPUTS 5
25,1 		! PumpCHWload:Outlet fluid temperature ->Chilled water inlet temperature
25,2 		! PumpCHWload:Outlet flow rate ->Chilled water flow rate
t_chillerset		! CalcTempCtrl:t_chillerset ->Set point temperature
87,4 		! HourlyLoads:Output 4 ->Ambient temperature
0,0		! [unconnected] Chiller control signal
*** INITIAL INPUT VALUES
t_chwmax 0 t_chillerset 30.0 1 
*** External files
ASSIGN "C:\Trnsys17\Tess Models\SampleCatalogData\AirCooledChiller\Samp_C.Dat" 55
*|? Which file contains the chiller performance data? |1000
ASSIGN "C:\Trnsys17\Tess Models\SampleCatalogData\AirCooledChiller\Samp_PLR.Dat" 56
*|? Which file contains the part-load performance data? |1000
*------------------------------------------------------------------------------

* Model "LoadCHW" (Type 682)
* 

UNIT 19 TYPE 682	 LoadCHW
*$UNIT_NAME LoadCHW
*$MODEL .\Loads and Structures (TESS)\Flowstream Loads\Other Fluids\Type682.tmf
*$POSITION 1530 659
*$LAYER Main # 
PARAMETERS 1
cp_chw		! 1 Fluid specific heat
INPUTS 5
58,1 		! Chiller:Outlet fluid temperature ->Inlet temperature
58,2 		! Chiller:Fluid flow rate ->Inlet flow rate
q_cool		! CalcHPctrl:q_cool ->Load
0,0		! [unconnected] Minimum Heating Temperature
0,0		! [unconnected] Maximum Cooling Temperature
*** INITIAL INPUT VALUES
t_chwmax 0 0.0 -999 999 
*------------------------------------------------------------------------------

* Model "vPumpS1" (Type 110)
* 

UNIT 13 TYPE 110	 vPumpS1
*$UNIT_NAME vPumpS1
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 438 204
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
m_hwmax		! 1 Rated flow rate
cp_src		! 2 Fluid specific heat
0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1.0		! 6 Power coefficient
INPUTS 5
57,1 		! Pipe_HP:Outlet temperature ->Inlet fluid temperature
13,2 		! vPumpS1:Outlet flow rate ->Inlet fluid flow rate
sig_vpumpS1		! CalcHPctrl:sig_vpumpS1 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
10 0 0 1 1 
*------------------------------------------------------------------------------

* Model "vPumpS2" (Type 110)
* 

UNIT 3 TYPE 110	 vPumpS2
*$UNIT_NAME vPumpS2
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 438 307
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
m_vpumpShalf		! 1 Rated flow rate
cp_src		! 2 Fluid specific heat
0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1.0		! 6 Power coefficient
INPUTS 5
57,1 		! Pipe_HP:Outlet temperature ->Inlet fluid temperature
3,2 		! vPumpS2:Outlet flow rate ->Inlet fluid flow rate
sig_vpumpS2		! CalcHPctrl:sig_vpumpS2 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
10 0 0 1 1 
*------------------------------------------------------------------------------

* Model "vPumpS3" (Type 110)
* 

UNIT 49 TYPE 110	 vPumpS3
*$UNIT_NAME vPumpS3
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 438 404
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
m_vpumpSmax		! 1 Rated flow rate
cp_src		! 2 Fluid specific heat
0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1.0		! 6 Power coefficient
INPUTS 5
57,1 		! Pipe_HP:Outlet temperature ->Inlet fluid temperature
49,2 		! vPumpS3:Outlet flow rate ->Inlet fluid flow rate
sig_vpumpS3		! CalcHPctrl:sig_vpumpS3 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
10 0 0 1 1 
*------------------------------------------------------------------------------

* Model "vPumpS4" (Type 110)
* 

UNIT 45 TYPE 110	 vPumpS4
*$UNIT_NAME vPumpS4
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 438 505
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
m_vpumpShalf		! 1 Rated flow rate
cp_src		! 2 Fluid specific heat
0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1.0		! 6 Power coefficient
INPUTS 5
57,1 		! Pipe_HP:Outlet temperature ->Inlet fluid temperature
45,2 		! vPumpS4:Outlet flow rate ->Inlet fluid flow rate
sig_vpumpS4		! CalcHPctrl:sig_vpumpS4 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
10 0 0 1 1 
*------------------------------------------------------------------------------

* Model "vPumpS5" (Type 110)
* 

UNIT 36 TYPE 110	 vPumpS5
*$UNIT_NAME vPumpS5
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 438 610
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
m_vpumpSmax		! 1 Rated flow rate
cp_src		! 2 Fluid specific heat
0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1.0		! 6 Power coefficient
INPUTS 5
57,1 		! Pipe_HP:Outlet temperature ->Inlet fluid temperature
36,2 		! vPumpS5:Outlet flow rate ->Inlet fluid flow rate
sig_vpumpS5		! CalcHPctrl:sig_vpumpS5 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
10 0 0 1 1 
*------------------------------------------------------------------------------

* Model "vPumpS6" (Type 110)
* 

UNIT 40 TYPE 110	 vPumpS6
*$UNIT_NAME vPumpS6
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 438 713
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
m_chwmax		! 1 Rated flow rate
cp_src		! 2 Fluid specific heat
0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1.0		! 6 Power coefficient
INPUTS 5
57,1 		! Pipe_HP:Outlet temperature ->Inlet fluid temperature
40,2 		! vPumpS6:Outlet flow rate ->Inlet fluid flow rate
sig_vpumpS6		! CalcHPctrl:sig_vpumpS6 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
10 0 0 1 1 
*------------------------------------------------------------------------------

* Model "vPumpH1" (Type 110)
* 

UNIT 14 TYPE 110	 vPumpH1
*$UNIT_NAME vPumpH1
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 708 204
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
m_hwmax		! 1 Rated flow rate
cp_hw		! 2 Fluid specific heat
0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1.0		! 6 Power coefficient
INPUTS 5
20,3 		! Tank_HW:Temperature at outlet-2 ->Inlet fluid temperature
14,2 		! vPumpH1:Outlet flow rate ->Inlet fluid flow rate
sig_vpumpH1		! CalcHPctrl:sig_vpumpH1 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
10 0 0 1 1 
*------------------------------------------------------------------------------

* Model "vPumpH2" (Type 110)
* 

UNIT 6 TYPE 110	 vPumpH2
*$UNIT_NAME vPumpH2
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 708 307
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
m_vpumpHhalf		! 1 Rated flow rate
cp_hw		! 2 Fluid specific heat
0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1.0		! 6 Power coefficient
INPUTS 5
20,3 		! Tank_HW:Temperature at outlet-2 ->Inlet fluid temperature
6,2 		! vPumpH2:Outlet flow rate ->Inlet fluid flow rate
sig_vpumpH2		! CalcHPctrl:sig_vpumpH2 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
10 0 0 1 1 
*------------------------------------------------------------------------------

* Model "vPumpH3" (Type 110)
* 

UNIT 50 TYPE 110	 vPumpH3
*$UNIT_NAME vPumpH3
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 708 404
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
m_vpumpHmax		! 1 Rated flow rate
cp_hw		! 2 Fluid specific heat
0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1.0		! 6 Power coefficient
INPUTS 5
20,3 		! Tank_HW:Temperature at outlet-2 ->Inlet fluid temperature
50,2 		! vPumpH3:Outlet flow rate ->Inlet fluid flow rate
sig_vpumpH3		! CalcHPctrl:sig_vpumpH3 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
10 0 0 1 1 
*------------------------------------------------------------------------------

* Model "vPumpH4" (Type 110)
* 

UNIT 42 TYPE 110	 vPumpH4
*$UNIT_NAME vPumpH4
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 1010 255
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
m_vpumpHhalf		! 1 Rated flow rate
cp_hw		! 2 Fluid specific heat
0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1.0		! 6 Power coefficient
INPUTS 5
20,3 		! Tank_HW:Temperature at outlet-2 ->Inlet fluid temperature
42,2 		! vPumpH4:Outlet flow rate ->Inlet fluid flow rate
sig_vpumpH4		! CalcHPctrl:sig_vpumpH4 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
10 0 0 1 1 
*------------------------------------------------------------------------------

* Model "vPumpH5" (Type 110)
* 

UNIT 52 TYPE 110	 vPumpH5
*$UNIT_NAME vPumpH5
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 1010 430
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
m_vpumpHmax		! 1 Rated flow rate
cp_hw		! 2 Fluid specific heat
0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1.0		! 6 Power coefficient
INPUTS 5
20,3 		! Tank_HW:Temperature at outlet-2 ->Inlet fluid temperature
52,2 		! vPumpH5:Outlet flow rate ->Inlet fluid flow rate
sig_vpumpH5		! CalcHPctrl:sig_vpumpH5 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
10 0 0 1 1 
*------------------------------------------------------------------------------

* Model "vPumpC1" (Type 110)
* 

UNIT 47 TYPE 110	 vPumpC1
*$UNIT_NAME vPumpC1
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 707 505
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
m_vpumpChalf		! 1 Rated flow rate
cp_chw		! 2 Fluid specific heat
0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1.0		! 6 Power coefficient
INPUTS 5
21,3 		! Tank_CHW:Temperature at outlet-2 ->Inlet fluid temperature
47,2 		! vPumpC1:Outlet flow rate ->Inlet fluid flow rate
sig_vpumpC1		! CalcHPctrl:sig_vpumpC1 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
10 0 0 1 1 
*------------------------------------------------------------------------------

* Model "vPumpC2" (Type 110)
* 

UNIT 37 TYPE 110	 vPumpC2
*$UNIT_NAME vPumpC2
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 707 610
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
m_vpumpCmax		! 1 Rated flow rate
cp_chw		! 2 Fluid specific heat
0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1.0		! 6 Power coefficient
INPUTS 5
21,3 		! Tank_CHW:Temperature at outlet-2 ->Inlet fluid temperature
37,2 		! vPumpC2:Outlet flow rate ->Inlet fluid flow rate
sig_vpumpC2		! CalcHPctrl:sig_vpumpC2 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
10 0 0 1 1 
*------------------------------------------------------------------------------

* Model "vPumpC3" (Type 110)
* 

UNIT 41 TYPE 110	 vPumpC3
*$UNIT_NAME vPumpC3
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 707 713
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
m_chwmax		! 1 Rated flow rate
cp_chw		! 2 Fluid specific heat
0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1.0		! 6 Power coefficient
INPUTS 5
21,3 		! Tank_CHW:Temperature at outlet-2 ->Inlet fluid temperature
41,2 		! vPumpC3:Outlet flow rate ->Inlet fluid flow rate
sig_vpumpC3		! CalcHPctrl:sig_vpumpC3 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
10 0 0 1 1 
*------------------------------------------------------------------------------

* Model "vPumpC4" (Type 110)
* 

UNIT 43 TYPE 110	 vPumpC4
*$UNIT_NAME vPumpC4
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 1009 340
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
m_vpumpChalf		! 1 Rated flow rate
cp_chw		! 2 Fluid specific heat
0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1.0		! 6 Power coefficient
INPUTS 5
21,3 		! Tank_CHW:Temperature at outlet-2 ->Inlet fluid temperature
43,2 		! vPumpC4:Outlet flow rate ->Inlet fluid flow rate
sig_vpumpC4		! CalcHPctrl:sig_vpumpC4 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
10 0 0 1 1 
*------------------------------------------------------------------------------

* Model "vPumpC5" (Type 110)
* 

UNIT 53 TYPE 110	 vPumpC5
*$UNIT_NAME vPumpC5
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 1009 515
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
m_vpumpCmax		! 1 Rated flow rate
cp_chw		! 2 Fluid specific heat
0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1.0		! 6 Power coefficient
INPUTS 5
21,3 		! Tank_CHW:Temperature at outlet-2 ->Inlet fluid temperature
53,2 		! vPumpC5:Outlet flow rate ->Inlet fluid flow rate
sig_vpumpC5		! CalcHPctrl:sig_vpumpC5 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
10 0 0 1 1 
*------------------------------------------------------------------------------

* Model "DHR_Stg2" (Type 1221)
* 

UNIT 51 TYPE 1221	 DHR_Stg2
*$UNIT_NAME DHR_Stg2
*$MODEL .\HVAC Library (TESS)\Water-Water Heat Pump\2-Stage\Type1221.tmf
*$POSITION 862 492
*$LAYER Main # 
PARAMETERS 27
cp_chw		! 1 Source fluid specific heat
cp_hw		! 2 Load fluid specific heat
rho_chw		! 3 Source fluid density
rho_hw		! 4 Load fluid density
51		! 5 Logical unit number for 1st stage cooling data file
52		! 6 Logical unit number for 2nd stage cooling data file
8		! 7 Number of source temperatures - cooling
4		! 8 Number of load temperatures - cooling
53		! 9 Logical unit for 1st stage heating data
54		! 10 Logical unit for 2nd stage heating data
6		! 11 Number of source temps. - heating
4		! 12 Number of load temps. - heating
3		! 13 Number of source flow rates
3		! 14 Number of load flow rates
q_cool_stg1		! 15 Rated 1st stage cooling capacity per heat pump
q_cool_stg2		! 16 Rated 2nd stage cooling capacity per heat pump
p_cool_stg1		! 17 Rated 1st stage cooling power per heat pump
p_cool_stg2		! 18 Rated 2nd stage cooling power per heat pump
q_heat_stg1		! 19 Rated 1st stage heating capacity per heat pump
q_heat_stg2		! 20 Rated 2nd stage heating capacity per heat pump
p_heat_stg1		! 21 Rated 1st stage heating power per heat pump
p_heat_stg2		! 22 Rated 2nd stage heating power per heat pump
lps_halfcool		! 23 Rated 1st stage source flow rate per heat pump
lps_loadcool		! 24 Rated 2nd stage source flow rate per heat pump
lps_halfheat		! 25 Rated 1st stage load flow rate per heat pump
lps_loadheat		! 26 Rated 2nd stage load flow rate per heat pump
n_modules		! 27 Number of identical heat pumps
INPUTS 10
53,1 		! vPumpC5:Outlet fluid temperature ->Inlet source temperature
53,2 		! vPumpC5:Outlet flow rate ->Source flow rate
52,1 		! vPumpH5:Outlet fluid temperature ->Inlet load temperature
52,2 		! vPumpH5:Outlet flow rate ->Load flow rate
0,0		! [unconnected] 1st Stage cooling control signal
0,0		! [unconnected] 2nd Stage cooling control signal
0,0		! [unconnected] 1st Stage heating control signal
0,0		! [unconnected] 2nd Stage heating control signal
0,0		! [unconnected] Scale factor
n_dhr_2nd		! CalcHPctrl:n_dhr_2nd ->Number of heat pumps on
*** INITIAL INPUT VALUES
40.0 0 20.0 0 0 0 1 1 1 1 
*** External files
ASSIGN "C:\Trnsys17\Tess Models\SampleCatalogData\Water-to-WaterHeatPump\Normalized 2-Stage\WWHP_1stStageCooling-Normalized.dat" 51
*|? Which file contains the 1st stage cooling performance data? |1000
ASSIGN "WWHP_MStack_1stStageHeating-Normalized.dat" 53
*|? Which file contains the 1st stage heating performance data? |1000
ASSIGN "C:\Trnsys17\Tess Models\SampleCatalogData\Water-to-WaterHeatPump\Normalized 2-Stage\WWHP_2ndStageCooling-Normalized.dat" 52
*|? Which file contains the 2nd stage cooling performance data? |1000
ASSIGN "WWHP_MStack_2ndStageHeating-Normalized.dat" 54
*|? Which file contains the 2nd stage heating performance data? |1000
*------------------------------------------------------------------------------

* Model "DHR_Stg1" (Type 1221)
* 

UNIT 38 TYPE 1221	 DHR_Stg1
*$UNIT_NAME DHR_Stg1
*$MODEL .\HVAC Library (TESS)\Water-Water Heat Pump\2-Stage\Type1221.tmf
*$POSITION 862 284
*$LAYER Main # 
PARAMETERS 27
cp_chw		! 1 Source fluid specific heat
cp_hw		! 2 Load fluid specific heat
rho_chw		! 3 Source fluid density
rho_hw		! 4 Load fluid density
38		! 5 Logical unit number for 1st stage cooling data file
39		! 6 Logical unit number for 2nd stage cooling data file
8		! 7 Number of source temperatures - cooling
4		! 8 Number of load temperatures - cooling
40		! 9 Logical unit for 1st stage heating data
41		! 10 Logical unit for 2nd stage heating data
6		! 11 Number of source temps. - heating
4		! 12 Number of load temps. - heating
3		! 13 Number of source flow rates
3		! 14 Number of load flow rates
q_cool_stg1		! 15 Rated 1st stage cooling capacity per heat pump
q_cool_stg2		! 16 Rated 2nd stage cooling capacity per heat pump
p_cool_stg1		! 17 Rated 1st stage cooling power per heat pump
p_cool_stg2		! 18 Rated 2nd stage cooling power per heat pump
q_heat_stg1		! 19 Rated 1st stage heating capacity per heat pump
q_heat_stg2		! 20 Rated 2nd stage heating capacity per heat pump
p_heat_stg1		! 21 Rated 1st stage heating power per heat pump
p_heat_stg2		! 22 Rated 2nd stage heating power per heat pump
lps_halfcool		! 23 Rated 1st stage source flow rate per heat pump
lps_loadcool		! 24 Rated 2nd stage source flow rate per heat pump
lps_halfheat		! 25 Rated 1st stage load flow rate per heat pump
lps_loadheat		! 26 Rated 2nd stage load flow rate per heat pump
n_modules		! 27 Number of identical heat pumps
INPUTS 10
43,1 		! vPumpC4:Outlet fluid temperature ->Inlet source temperature
43,2 		! vPumpC4:Outlet flow rate ->Source flow rate
42,1 		! vPumpH4:Outlet fluid temperature ->Inlet load temperature
42,2 		! vPumpH4:Outlet flow rate ->Load flow rate
0,0		! [unconnected] 1st Stage cooling control signal
0,0		! [unconnected] 2nd Stage cooling control signal
0,0		! [unconnected] 1st Stage heating control signal
0,0		! [unconnected] 2nd Stage heating control signal
0,0		! [unconnected] Scale factor
n_dhr_1st		! CalcHPctrl:n_dhr_1st ->Number of heat pumps on
*** INITIAL INPUT VALUES
40.0 0 20.0 0 0 0 1 0 1 1 
*** External files
ASSIGN "C:\Trnsys17\Tess Models\SampleCatalogData\Water-to-WaterHeatPump\Normalized 2-Stage\WWHP_1stStageCooling-Normalized.dat" 38
*|? Which file contains the 1st stage cooling performance data? |1000
ASSIGN "WWHP_MStack_1stStageHeating-Normalized.dat" 40
*|? Which file contains the 1st stage heating performance data? |1000
ASSIGN "C:\Trnsys17\Tess Models\SampleCatalogData\Water-to-WaterHeatPump\Normalized 2-Stage\WWHP_2ndStageCooling-Normalized.dat" 39
*|? Which file contains the 2nd stage cooling performance data? |1000
ASSIGN "WWHP_MStack_2ndStageHeating-Normalized.dat" 41
*|? Which file contains the 2nd stage heating performance data? |1000
*------------------------------------------------------------------------------

* Model "Cool_Stg2" (Type 1221)
* 

UNIT 35 TYPE 1221	 Cool_Stg2
*$UNIT_NAME Cool_Stg2
*$MODEL .\HVAC Library (TESS)\Water-Water Heat Pump\2-Stage\Type1221.tmf
*$POSITION 572 587
*$LAYER Main # 
PARAMETERS 27
cp_src		! 1 Source fluid specific heat
cp_chw		! 2 Load fluid specific heat
rho_src		! 3 Source fluid density
rho_chw		! 4 Load fluid density
34		! 5 Logical unit number for 1st stage cooling data file
35		! 6 Logical unit number for 2nd stage cooling data file
8		! 7 Number of source temperatures - cooling
4		! 8 Number of load temperatures - cooling
36		! 9 Logical unit for 1st stage heating data
37		! 10 Logical unit for 2nd stage heating data
6		! 11 Number of source temps. - heating
4		! 12 Number of load temps. - heating
3		! 13 Number of source flow rates
3		! 14 Number of load flow rates
q_cool_stg1		! 15 Rated 1st stage cooling capacity per heat pump
q_cool_stg2		! 16 Rated 2nd stage cooling capacity per heat pump
p_cool_stg1		! 17 Rated 1st stage cooling power per heat pump
p_cool_stg2		! 18 Rated 2nd stage cooling power per heat pump
q_heat_stg1		! 19 Rated 1st stage heating capacity per heat pump
q_heat_stg2		! 20 Rated 2nd stage heating capacity per heat pump
p_heat_stg1		! 21 Rated 1st stage heating power per heat pump
p_heat_stg2		! 22 Rated 2nd stage heating power per heat pump
lps_halfsource		! 23 Rated 1st stage source flow rate per heat pump
lps_source		! 24 Rated 2nd stage source flow rate per heat pump
lps_halfcool		! 25 Rated 1st stage load flow rate per heat pump
lps_loadcool		! 26 Rated 2nd stage load flow rate per heat pump
n_modules		! 27 Number of identical heat pumps
INPUTS 10
36,1 		! vPumpS5:Outlet fluid temperature ->Inlet source temperature
36,2 		! vPumpS5:Outlet flow rate ->Source flow rate
37,1 		! vPumpC2:Outlet fluid temperature ->Inlet load temperature
37,2 		! vPumpC2:Outlet flow rate ->Load flow rate
0,0		! [unconnected] 1st Stage cooling control signal
0,0		! [unconnected] 2nd Stage cooling control signal
0,0		! [unconnected] 1st Stage heating control signal
0,0		! [unconnected] 2nd Stage heating control signal
0,0		! [unconnected] Scale factor
n_cool_2nd		! CalcHPctrl:n_cool_2nd ->Number of heat pumps on
*** INITIAL INPUT VALUES
40.0 0 20.0 0 1 1 0 0 1 1 
*** External files
ASSIGN "C:\Trnsys17\Tess Models\SampleCatalogData\Water-to-WaterHeatPump\Normalized 2-Stage\WWHP_1stStageCooling-Normalized.dat" 34
*|? Which file contains the 1st stage cooling performance data? |1000
ASSIGN "WWHP_MStack_1stStageHeating-Normalized.dat" 36
*|? Which file contains the 1st stage heating performance data? |1000
ASSIGN "C:\Trnsys17\Tess Models\SampleCatalogData\Water-to-WaterHeatPump\Normalized 2-Stage\WWHP_2ndStageCooling-Normalized.dat" 35
*|? Which file contains the 2nd stage cooling performance data? |1000
ASSIGN "WWHP_MStack_2ndStageHeating-Normalized.dat" 37
*|? Which file contains the 2nd stage heating performance data? |1000
*------------------------------------------------------------------------------

* Model "Cool_Stg1" (Type 1221)
* 

UNIT 46 TYPE 1221	 Cool_Stg1
*$UNIT_NAME Cool_Stg1
*$MODEL .\HVAC Library (TESS)\Water-Water Heat Pump\2-Stage\Type1221.tmf
*$POSITION 572 482
*$LAYER Main # 
PARAMETERS 27
cp_src		! 1 Source fluid specific heat
cp_chw		! 2 Load fluid specific heat
rho_src		! 3 Source fluid density
rho_chw		! 4 Load fluid density
43		! 5 Logical unit number for 1st stage cooling data file
44		! 6 Logical unit number for 2nd stage cooling data file
8		! 7 Number of source temperatures - cooling
4		! 8 Number of load temperatures - cooling
45		! 9 Logical unit for 1st stage heating data
46		! 10 Logical unit for 2nd stage heating data
6		! 11 Number of source temps. - heating
4		! 12 Number of load temps. - heating
3		! 13 Number of source flow rates
3		! 14 Number of load flow rates
q_cool_stg1		! 15 Rated 1st stage cooling capacity per heat pump
q_cool_stg2		! 16 Rated 2nd stage cooling capacity per heat pump
p_cool_stg1		! 17 Rated 1st stage cooling power per heat pump
p_cool_stg2		! 18 Rated 2nd stage cooling power per heat pump
q_heat_stg1		! 19 Rated 1st stage heating capacity per heat pump
q_heat_stg2		! 20 Rated 2nd stage heating capacity per heat pump
p_heat_stg1		! 21 Rated 1st stage heating power per heat pump
p_heat_stg2		! 22 Rated 2nd stage heating power per heat pump
lps_halfsource		! 23 Rated 1st stage source flow rate per heat pump
lps_source		! 24 Rated 2nd stage source flow rate per heat pump
lps_halfcool		! 25 Rated 1st stage load flow rate per heat pump
lps_loadcool		! 26 Rated 2nd stage load flow rate per heat pump
n_modules		! 27 Number of identical heat pumps
INPUTS 10
45,1 		! vPumpS4:Outlet fluid temperature ->Inlet source temperature
45,2 		! vPumpS4:Outlet flow rate ->Source flow rate
47,1 		! vPumpC1:Outlet fluid temperature ->Inlet load temperature
47,2 		! vPumpC1:Outlet flow rate ->Load flow rate
0,0		! [unconnected] 1st Stage cooling control signal
0,0		! [unconnected] 2nd Stage cooling control signal
0,0		! [unconnected] 1st Stage heating control signal
0,0		! [unconnected] 2nd Stage heating control signal
0,0		! [unconnected] Scale factor
n_cool_1st		! CalcHPctrl:n_cool_1st ->Number of heat pumps on
*** INITIAL INPUT VALUES
40.0 0 20.0 0 1 0 0 0 1 1 
*** External files
ASSIGN "C:\Trnsys17\Tess Models\SampleCatalogData\Water-to-WaterHeatPump\Normalized 2-Stage\WWHP_1stStageCooling-Normalized.dat" 43
*|? Which file contains the 1st stage cooling performance data? |1000
ASSIGN "WWHP_MStack_1stStageHeating-Normalized.dat" 45
*|? Which file contains the 1st stage heating performance data? |1000
ASSIGN "C:\Trnsys17\Tess Models\SampleCatalogData\Water-to-WaterHeatPump\Normalized 2-Stage\WWHP_2ndStageCooling-Normalized.dat" 44
*|? Which file contains the 2nd stage cooling performance data? |1000
ASSIGN "WWHP_MStack_2ndStageHeating-Normalized.dat" 46
*|? Which file contains the 2nd stage heating performance data? |1000
*------------------------------------------------------------------------------

* Model "Heat_Stg2" (Type 1221)
* 

UNIT 48 TYPE 1221	 Heat_Stg2
*$UNIT_NAME Heat_Stg2
*$MODEL .\HVAC Library (TESS)\Water-Water Heat Pump\2-Stage\Type1221.tmf
*$POSITION 572 381
*$LAYER Main # 
PARAMETERS 27
cp_src		! 1 Source fluid specific heat
cp_hw		! 2 Load fluid specific heat
rho_src		! 3 Source fluid density
rho_hw		! 4 Load fluid density
47		! 5 Logical unit number for 1st stage cooling data file
48		! 6 Logical unit number for 2nd stage cooling data file
8		! 7 Number of source temperatures - cooling
4		! 8 Number of load temperatures - cooling
49		! 9 Logical unit for 1st stage heating data
50		! 10 Logical unit for 2nd stage heating data
6		! 11 Number of source temps. - heating
4		! 12 Number of load temps. - heating
3		! 13 Number of source flow rates
3		! 14 Number of load flow rates
q_cool_stg1		! 15 Rated 1st stage cooling capacity per heat pump
q_cool_stg2		! 16 Rated 2nd stage cooling capacity per heat pump
p_cool_stg1		! 17 Rated 1st stage cooling power per heat pump
p_cool_stg2		! 18 Rated 2nd stage cooling power per heat pump
q_heat_stg1		! 19 Rated 1st stage heating capacity per heat pump
q_heat_stg2		! 20 Rated 2nd stage heating capacity per heat pump
p_heat_stg1		! 21 Rated 1st stage heating power per heat pump
p_heat_stg2		! 22 Rated 2nd stage heating power per heat pump
lps_halfsource		! 23 Rated 1st stage source flow rate per heat pump
lps_source		! 24 Rated 2nd stage source flow rate per heat pump
lps_halfheat		! 25 Rated 1st stage load flow rate per heat pump
lps_loadheat		! 26 Rated 2nd stage load flow rate per heat pump
n_modules		! 27 Number of identical heat pumps
INPUTS 10
49,1 		! vPumpS3:Outlet fluid temperature ->Inlet source temperature
49,2 		! vPumpS3:Outlet flow rate ->Source flow rate
50,1 		! vPumpH3:Outlet fluid temperature ->Inlet load temperature
50,2 		! vPumpH3:Outlet flow rate ->Load flow rate
0,0		! [unconnected] 1st Stage cooling control signal
0,0		! [unconnected] 2nd Stage cooling control signal
0,0		! [unconnected] 1st Stage heating control signal
0,0		! [unconnected] 2nd Stage heating control signal
0,0		! [unconnected] Scale factor
n_heat_2nd		! CalcHPctrl:n_heat_2nd ->Number of heat pumps on
*** INITIAL INPUT VALUES
40.0 0 20.0 0 0 0 1 1 1 1 
*** External files
ASSIGN "C:\Trnsys17\Tess Models\SampleCatalogData\Water-to-WaterHeatPump\Normalized 2-Stage\WWHP_1stStageCooling-Normalized.dat" 47
*|? Which file contains the 1st stage cooling performance data? |1000
ASSIGN "WWHP_MStack_1stStageHeating-Normalized.dat" 49
*|? Which file contains the 1st stage heating performance data? |1000
ASSIGN "C:\Trnsys17\Tess Models\SampleCatalogData\Water-to-WaterHeatPump\Normalized 2-Stage\WWHP_2ndStageCooling-Normalized.dat" 48
*|? Which file contains the 2nd stage cooling performance data? |1000
ASSIGN "WWHP_MStack_2ndStageHeating-Normalized.dat" 50
*|? Which file contains the 2nd stage heating performance data? |1000
*------------------------------------------------------------------------------

* Model "Heat_Stg1" (Type 1221)
* 

UNIT 2 TYPE 1221	 Heat_Stg1
*$UNIT_NAME Heat_Stg1
*$MODEL .\HVAC Library (TESS)\Water-Water Heat Pump\2-Stage\Type1221.tmf
*$POSITION 572 284
*$LAYER Main # 
PARAMETERS 27
cp_src		! 1 Source fluid specific heat
cp_hw		! 2 Load fluid specific heat
rho_src		! 3 Source fluid density
rho_hw		! 4 Load fluid density
30		! 5 Logical unit number for 1st stage cooling data file
31		! 6 Logical unit number for 2nd stage cooling data file
8		! 7 Number of source temperatures - cooling
4		! 8 Number of load temperatures - cooling
32		! 9 Logical unit for 1st stage heating data
33		! 10 Logical unit for 2nd stage heating data
6		! 11 Number of source temps. - heating
4		! 12 Number of load temps. - heating
3		! 13 Number of source flow rates
3		! 14 Number of load flow rates
q_cool_stg1		! 15 Rated 1st stage cooling capacity per heat pump
q_cool_stg2		! 16 Rated 2nd stage cooling capacity per heat pump
p_cool_stg1		! 17 Rated 1st stage cooling power per heat pump
p_cool_stg2		! 18 Rated 2nd stage cooling power per heat pump
q_heat_stg1		! 19 Rated 1st stage heating capacity per heat pump
q_heat_stg2		! 20 Rated 2nd stage heating capacity per heat pump
p_heat_stg1		! 21 Rated 1st stage heating power per heat pump
p_heat_stg2		! 22 Rated 2nd stage heating power per heat pump
lps_halfsource		! 23 Rated 1st stage source flow rate per heat pump
lps_source		! 24 Rated 2nd stage source flow rate per heat pump
lps_halfheat		! 25 Rated 1st stage load flow rate per heat pump
lps_loadheat		! 26 Rated 2nd stage load flow rate per heat pump
n_modules		! 27 Number of identical heat pumps
INPUTS 10
3,1 		! vPumpS2:Outlet fluid temperature ->Inlet source temperature
3,2 		! vPumpS2:Outlet flow rate ->Source flow rate
6,1 		! vPumpH2:Outlet fluid temperature ->Inlet load temperature
6,2 		! vPumpH2:Outlet flow rate ->Load flow rate
0,0		! [unconnected] 1st Stage cooling control signal
0,0		! [unconnected] 2nd Stage cooling control signal
0,0		! [unconnected] 1st Stage heating control signal
0,0		! [unconnected] 2nd Stage heating control signal
0,0		! [unconnected] Scale factor
n_heat_1st		! CalcHPctrl:n_heat_1st ->Number of heat pumps on
*** INITIAL INPUT VALUES
40.0 0 20.0 0 0 0 1 0 1 1 
*** External files
ASSIGN "C:\Trnsys17\Tess Models\SampleCatalogData\Water-to-WaterHeatPump\Normalized 2-Stage\WWHP_1stStageCooling-Normalized.dat" 30
*|? Which file contains the 1st stage cooling performance data? |1000
ASSIGN "WWHP_MStack_1stStageHeating-Normalized.dat" 32
*|? Which file contains the 1st stage heating performance data? |1000
ASSIGN "C:\Trnsys17\Tess Models\SampleCatalogData\Water-to-WaterHeatPump\Normalized 2-Stage\WWHP_2ndStageCooling-Normalized.dat" 31
*|? Which file contains the 2nd stage cooling performance data? |1000
ASSIGN "WWHP_MStack_2ndStageHeating-Normalized.dat" 33
*|? Which file contains the 2nd stage heating performance data? |1000
*------------------------------------------------------------------------------

* Model "FreeCool" (Type 91)
* 

UNIT 39 TYPE 91	 FreeCool
*$UNIT_NAME FreeCool
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 570 688
*$LAYER Main # 
PARAMETERS 3
1		! 1 Heat exchanger effectiveness
cp_src		! 2 Specific heat of source side fluid
cp_chw		! 3 Specific heat of load side fluid
INPUTS 4
40,1 		! vPumpS6:Outlet fluid temperature ->Source side inlet temperature
40,2 		! vPumpS6:Outlet flow rate ->Source side flow rate
41,1 		! vPumpC3:Outlet fluid temperature ->Load side inlet temperature
41,2 		! vPumpC3:Outlet flow rate ->Load side flow rate
*** INITIAL INPUT VALUES
10 0 10 0 
*------------------------------------------------------------------------------

* Model "FreeHeat" (Type 91)
* 

UNIT 12 TYPE 91	 FreeHeat
*$UNIT_NAME FreeHeat
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 570 180
*$LAYER Main # 
PARAMETERS 3
1		! 1 Heat exchanger effectiveness
cp_src		! 2 Specific heat of source side fluid
cp_hw		! 3 Specific heat of load side fluid
INPUTS 4
13,1 		! vPumpS1:Outlet fluid temperature ->Source side inlet temperature
13,2 		! vPumpS1:Outlet flow rate ->Source side flow rate
14,1 		! vPumpH1:Outlet fluid temperature ->Load side inlet temperature
14,2 		! vPumpH1:Outlet flow rate ->Load side flow rate
*** INITIAL INPUT VALUES
10 0 10 0 
*------------------------------------------------------------------------------

* Model "Mix_CHWS" (Type 649)
* 

UNIT 8 TYPE 649	 Mix_CHWS
*$UNIT_NAME Mix_CHWS
*$MODEL .\Hydronics Library (TESS)\Valves\Mixing Valve (100 Ports)\Other Fluids\Type649.tmf
*$POSITION 854 660
*$LAYER Main # 
PARAMETERS 1
5		! 1 Number of inlets
INPUTS 10
46,3 		! Cool_Stg1:Outlet load temperature ->Temperature at inlet-1
46,4 		! Cool_Stg1:Load flow rate ->Flow rate at inlet-1
35,3 		! Cool_Stg2:Outlet load temperature ->Temperature at inlet-2
35,4 		! Cool_Stg2:Load flow rate ->Flow rate at inlet-2
39,3 		! FreeCool:Load side outlet temperature ->Temperature at inlet-3
39,4 		! FreeCool:Load side flow rate ->Flow rate at inlet-3
38,1 		! DHR_Stg1:Outlet source temperature ->Temperature at inlet-4
38,2 		! DHR_Stg1:Source flow rate ->Flow rate at inlet-4
51,1 		! DHR_Stg2:Outlet source temperature ->Temperature at inlet-5
51,2 		! DHR_Stg2:Source flow rate ->Flow rate at inlet-5
*** INITIAL INPUT VALUES
10 0 10 0 10 0 10 0 10 0 
*------------------------------------------------------------------------------

* Model "PumpCHW" (Type 743)
* 

UNIT 54 TYPE 743	 PumpCHW
*$UNIT_NAME PumpCHW
*$MODEL .\Hydronics Library (TESS)\Pumps\Input the Flow Rate\Variable-Speed\Power from Polynomial Relationship\Type743.tmf
*$POSITION 1012 659
*$LAYER Main # 
*$# PUMP - INLET FLOW RATE KNOWN - POWER COEFFICIENTS
PARAMETERS 8
m_pumpCHWmax		! 1 Rated flow rate
cp_chw		! 2 Fluid specific heat
p_pumpCHWmax		! 3 Rated power
0.0		! 4 Motor heat loss fraction
3		! 5 Number of power coefficients
0		! 6 Power coefficient-1
0.9		! 7 Power coefficient-2
0.1		! 8 Power coefficient-3
INPUTS 4
8,1 		! Mix_CHWS:Outlet temperature ->Inlet fluid temperature
8,2 		! Mix_CHWS:Outlet flow rate ->Inlet fluid flow rate
effHPpump		! [equation] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
10 0.0 effHPpump 0.95 
*------------------------------------------------------------------------------

* Model "Mix_HWS" (Type 649)
* 

UNIT 7 TYPE 649	 Mix_HWS
*$UNIT_NAME Mix_HWS
*$MODEL .\Hydronics Library (TESS)\Valves\Mixing Valve (100 Ports)\Other Fluids\Type649.tmf
*$POSITION 854 152
*$LAYER Main # 
PARAMETERS 1
5		! 1 Number of inlets
INPUTS 10
12,3 		! FreeHeat:Load side outlet temperature ->Temperature at inlet-1
12,4 		! FreeHeat:Load side flow rate ->Flow rate at inlet-1
2,3 		! Heat_Stg1:Outlet load temperature ->Temperature at inlet-2
2,4 		! Heat_Stg1:Load flow rate ->Flow rate at inlet-2
48,3 		! Heat_Stg2:Outlet load temperature ->Temperature at inlet-3
48,4 		! Heat_Stg2:Load flow rate ->Flow rate at inlet-3
38,3 		! DHR_Stg1:Outlet load temperature ->Temperature at inlet-4
38,4 		! DHR_Stg1:Load flow rate ->Flow rate at inlet-4
51,3 		! DHR_Stg2:Outlet load temperature ->Temperature at inlet-5
51,4 		! DHR_Stg2:Load flow rate ->Flow rate at inlet-5
*** INITIAL INPUT VALUES
10 0 10 0 10 0 10 0 10 0 
*------------------------------------------------------------------------------

* Model "PumpHW" (Type 743)
* 

UNIT 55 TYPE 743	 PumpHW
*$UNIT_NAME PumpHW
*$MODEL .\Hydronics Library (TESS)\Pumps\Input the Flow Rate\Variable-Speed\Power from Polynomial Relationship\Type743.tmf
*$POSITION 1010 151
*$LAYER Main # 
*$# PUMP - INLET FLOW RATE KNOWN - POWER COEFFICIENTS
PARAMETERS 8
m_pumpHWmax		! 1 Rated flow rate
cp_hw		! 2 Fluid specific heat
p_pumpHWmax		! 3 Rated power
0.0		! 4 Motor heat loss fraction
3		! 5 Number of power coefficients
0		! 6 Power coefficient-1
0.9		! 7 Power coefficient-2
0.1		! 8 Power coefficient-3
INPUTS 4
7,1 		! Mix_HWS:Outlet temperature ->Inlet fluid temperature
7,2 		! Mix_HWS:Outlet flow rate ->Inlet fluid flow rate
effHPpump		! [equation] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
10 0.0 effHPpump 0.95 
*------------------------------------------------------------------------------

* Model "Mix_GHX" (Type 649)
* 

UNIT 9 TYPE 649	 Mix_GHX
*$UNIT_NAME Mix_GHX
*$MODEL .\Hydronics Library (TESS)\Valves\Mixing Valve (100 Ports)\Other Fluids\Type649.tmf
*$POSITION 290 660
*$LAYER Main # 
PARAMETERS 1
6		! 1 Number of inlets
INPUTS 12
12,1 		! FreeHeat:Source-side outlet temperature ->Temperature at inlet-1
12,2 		! FreeHeat:Source side flow rate ->Flow rate at inlet-1
2,1 		! Heat_Stg1:Outlet source temperature ->Temperature at inlet-2
2,2 		! Heat_Stg1:Source flow rate ->Flow rate at inlet-2
48,1 		! Heat_Stg2:Outlet source temperature ->Temperature at inlet-3
48,2 		! Heat_Stg2:Source flow rate ->Flow rate at inlet-3
46,1 		! Cool_Stg1:Outlet source temperature ->Temperature at inlet-4
46,2 		! Cool_Stg1:Source flow rate ->Flow rate at inlet-4
35,1 		! Cool_Stg2:Outlet source temperature ->Temperature at inlet-5
35,2 		! Cool_Stg2:Source flow rate ->Flow rate at inlet-5
39,1 		! FreeCool:Source-side outlet temperature ->Temperature at inlet-6
39,2 		! FreeCool:Source side flow rate ->Flow rate at inlet-6
*** INITIAL INPUT VALUES
10 0 10 0 10 0 10 0 10 0 10 0 
*------------------------------------------------------------------------------

* Model "PumpSRC" (Type 743)
* 

UNIT 56 TYPE 743	 PumpSRC
*$UNIT_NAME PumpSRC
*$MODEL .\Hydronics Library (TESS)\Pumps\Input the Flow Rate\Variable-Speed\Power from Polynomial Relationship\Type743.tmf
*$POSITION 165 857
*$LAYER Main # 
*$# PUMP - INLET FLOW RATE KNOWN - POWER COEFFICIENTS
PARAMETERS 8
m_pumpSRCmax		! 1 Rated flow rate
cp_src		! 2 Fluid specific heat
p_pumpSRCmax		! 3 Rated power
0.0		! 4 Motor heat loss fraction
3		! 5 Number of power coefficients
0		! 6 Power coefficient-1
0.9		! 7 Power coefficient-2
0.1		! 8 Power coefficient-3
INPUTS 4
9,1 		! Mix_GHX:Outlet temperature ->Inlet fluid temperature
9,2 		! Mix_GHX:Outlet flow rate ->Inlet fluid flow rate
effHPpump		! [equation] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
10 0.0 effHPpump 0.95 
*------------------------------------------------------------------------------

* EQUATIONS "PRIM-SEC CALC"
* 
EQUATIONS 8
hp_flow_nonzero = max([56,2], 0.001)
ghex_flow_nonzero = max([23,2], 0.001)
hp_bypass_flow = max(0, [23,2] - [56,2])
ghex_bypass_flow = max(0, [56,2] - [23,2])
sig_hp_divert_2 = min(1, ghex_bypass_flow/hp_flow_nonzero)
sig_hp_divert_1 = 1- sig_hp_divert_2
sig_ghex_divert_2 = min(1, hp_bypass_flow/ghex_flow_nonzero)
sig_ghex_divert_1 = 1 - sig_ghex_divert_2
*$UNIT_NAME PRIM-SEC CALC
*$LAYER Main
*$POSITION 473 238

*------------------------------------------------------------------------------


* Model "Astat_loophigh" (Type 1503)
* 

UNIT 80 TYPE 1503	 Astat_loophigh
*$UNIT_NAME Astat_loophigh
*$MODEL .\Controllers Library (TESS)\Aquastats\Cooling Mode\Type1503.tmf
*$POSITION 135 63
*$LAYER Main # 
PARAMETERS 4
1		! 1 Number of cooling stages
5		! 2 # oscillations permitted
dt_ctrl		! 3 Temperature dead band
0		! 4 Number of stage exceptions
INPUTS 3
56,1 		! PumpSRC:Outlet fluid temperature ->Fluid temperature
0,0		! [unconnected] Lockout signal
t_bhepumphigh		! [equation] Setpoint temperature for stage
*** INITIAL INPUT VALUES
10 0 t_bhepumphigh 
*------------------------------------------------------------------------------

* Model "Astat_looplow" (Type 1502)
* 

UNIT 81 TYPE 1502	 Astat_looplow
*$UNIT_NAME Astat_looplow
*$MODEL .\Controllers Library (TESS)\Aquastats\Heating Mode\Type1502.tmf
*$POSITION 135 138
*$LAYER Main # 
PARAMETERS 4
1		! 1 Number of heating stages
5		! 2 # oscillations permitted
dt_ctrl		! 3 Temperature dead band
0		! 4 Number of stage exceptions
INPUTS 3
56,1 		! PumpSRC:Outlet fluid temperature ->Fluid temperature
0,0		! [unconnected] Lockout signal
t_bhepumplow		! [equation] Setpoint temperature for stage
*** INITIAL INPUT VALUES
10 0 t_bhepumplow 
*------------------------------------------------------------------------------

* Model "FROM_GHEX" (Type 647)
* 

UNIT 30 TYPE 647	 FROM_GHEX
*$UNIT_NAME FROM_GHEX
*$MODEL .\Hydronics Library (TESS)\Valves\Diverting Valve (100 Ports)\Other Fluids\Type647.tmf
*$POSITION 287 333
*$LAYER Main # 
PARAMETERS 1
2		! 1 Number of outlet ports
INPUTS 4
23,1 		! Pipe_BHE:Outlet temperature ->Inlet Temperature
23,2 		! Pipe_BHE:Outlet flow rate ->Inlet flow rate
sig_ghex_divert_1		! PRIM-SEC CALC:sig_ghex_divert_1 ->Fraction of flow to outlet -1
sig_ghex_divert_2		! PRIM-SEC CALC:sig_ghex_divert_2 ->Fraction of flow to outlet -2
*** INITIAL INPUT VALUES
10 0 1 0 
*------------------------------------------------------------------------------

* Model "FROM_HP" (Type 647)
* 

UNIT 29 TYPE 647	 FROM_HP
*$UNIT_NAME FROM_HP
*$MODEL .\Hydronics Library (TESS)\Valves\Diverting Valve (100 Ports)\Other Fluids\Type647.tmf
*$POSITION 624 333
*$LAYER Main # 
PARAMETERS 1
2		! 1 Number of outlet ports
INPUTS 4
56,1 		! PumpSRC:Outlet fluid temperature ->Inlet Temperature
56,2 		! PumpSRC:Outlet flow rate ->Inlet flow rate
sig_hp_divert_1		! PRIM-SEC CALC:sig_hp_divert_1 ->Fraction of flow to outlet -1
sig_hp_divert_2		! PRIM-SEC CALC:sig_hp_divert_2 ->Fraction of flow to outlet -2
*** INITIAL INPUT VALUES
10 0 1 0 
*------------------------------------------------------------------------------

* EQUATIONS "CtrlBHEpump"
* 
EQUATIONS 6
m_bhemax = n_bhe * brfr  ! kg/hr
m_bhe = [56,2] * max([80,1], [81,1])  ! kg/hr, match HP flow if HX needed
effbhepump = 0.65  ! the efficiency of the bhe pump
p_bhemax = m_bhemax * dP_bhe * length_hdpe / (rho_src * effbhepump)  ! kJ/hr
sig_bhemin = 0.05  ! the minimum flow fraction
sig_bhepump = enable_bhe * min(max(m_bhe / m_bhemax, sig_bhemin), 1)
*$UNIT_NAME CtrlBHEpump
*$LAYER Main
*$POSITION 474 63

*------------------------------------------------------------------------------


* Model "TO_GHEX" (Type 649)
* 

UNIT 27 TYPE 649	 TO_GHEX
*$UNIT_NAME TO_GHEX
*$MODEL .\Hydronics Library (TESS)\Valves\Mixing Valve (100 Ports)\Other Fluids\Type649.tmf
*$POSITION 740 333
*$LAYER Main # 
PARAMETERS 1
2		! 1 Number of inlets
INPUTS 4
29,1 		! FROM_HP:Outlet temperature-1 ->Temperature at inlet-1
29,2 		! FROM_HP:Outlet flow rate-1 ->Flow rate at inlet-1
30,3 		! FROM_GHEX:Outlet temperature-2 ->Temperature at inlet-2
30,4 		! FROM_GHEX:Outlet flow rate-2 ->Flow rate at inlet-2
*** INITIAL INPUT VALUES
10 0 10 0 
*------------------------------------------------------------------------------

* Model "TO_HP" (Type 649)
* 

UNIT 28 TYPE 649	 TO_HP
*$UNIT_NAME TO_HP
*$MODEL .\Hydronics Library (TESS)\Valves\Mixing Valve (100 Ports)\Other Fluids\Type649.tmf
*$POSITION 403 333
*$LAYER Main # 
PARAMETERS 1
2		! 1 Number of inlets
INPUTS 4
30,1 		! FROM_GHEX:Outlet temperature-1 ->Temperature at inlet-1
30,2 		! FROM_GHEX:Outlet flow rate-1 ->Flow rate at inlet-1
29,3 		! FROM_HP:Outlet temperature-2 ->Temperature at inlet-2
29,4 		! FROM_HP:Outlet flow rate-2 ->Flow rate at inlet-2
*** INITIAL INPUT VALUES
10 0 10 0 
*------------------------------------------------------------------------------

* Model "PumpBHE" (Type 110)
* 

UNIT 31 TYPE 110	 PumpBHE
*$UNIT_NAME PumpBHE
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 439 857
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 8
m_bhemax		! 1 Rated flow rate
cp_src		! 2 Fluid specific heat
p_bhemax		! 3 Rated power
0.0		! 4 Motor heat loss fraction
3		! 5 Number of power coefficients
0		! 6 Power coefficient-1
0		! 7 Power coefficient-2
1.0		! 8 Power coefficient-3
INPUTS 5
27,1 		! TO_GHEX:Outlet temperature ->Inlet fluid temperature
31,2 		! PumpBHE:Outlet flow rate ->Inlet fluid flow rate
sig_bhepump		! CtrlBHEpump:sig_bhepump ->Control signal
effbhepump		! [equation] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
t_ground 0.0 0 effbhepump 0.95 
*------------------------------------------------------------------------------

* Model "BHE" (Type 557)
* 

UNIT 22 TYPE 557	 BHE
*$UNIT_NAME BHE
*$MODEL .\GHP Library (TESS)\Ground Heat Exchangers\Vertical\U-Tube\Standard\Type557a.tmf
*$POSITION 572 877
*$LAYER Main # 
PARAMETERS 44
stgvol		! 1 Storage volume
depth		! 2 Borehole depth
depth_hzpipe		! 3 Header depth
n_bhe		! 4 Number of boreholes
rad_bore		! 5 Borehole radius
1		! 6 No. of boreholes in series
1		! 7 Number of radial regions
50		! 8 Number of vertical regions
k_soil		! 9 Storage thermal conductivity
rhocp_soil		! 10 Storage heat capacity
-1		! 11 Negative of u-tubes/bore
ro_pipe		! 12 Outer radius of u-tube pipe
ri_pipe		! 13 Inner radius of u-tube pipe
shank_spacing		! 14 Center-to-center half distance
k_fill		! 15 Fill thermal conductivity
1.8		! 16 Pipe thermal conductivity
5.040		! 17 Gap thermal conductivity
0.0		! 18 Gap thickness
brfr		! 19 Reference borehole flow rate
30.0		! 20 Reference temperature
-1		! 21 Pipe to pipe heat transfer
cp_src		! 22 Fluid specific heat
rho_src		! 23 Fluid density
0		! 24 Insulation indicator
0.5		! 25 Insulation height fraction
0.0254		! 26 Insulation thickness
1.0		! 27 Insulation thermal conductivity
sim_years		! 28 Number of simulation years
100.0		! 29 Maximum storage temperature
t_ground		! 30 Initial surface temperature of storage volume
0.0		! 31 Initial thermal gradient of storage volume
0		! 32 Number of preheating years
30.0		! 33 Maximum preheat temperature
10.0		! 34 Minimum preheat temperature
90		! 35 Preheat phase delay
t_ground		! 36 Average air temperature - preheat years
13.6		! 37 Amplitude of air temperature - preheat years
248		! 38 Air temperature phase delay - preheat years
1		! 39 Number of ground layers
k_soil		! 40 Thermal conductivity of layer 
rhocp_soil		! 41 Heat capacity of layer 
1000.0		! 42 Thickness of layer
0		! 43 Not used (printing 1)
0		! 44 Not used (printing 2)
INPUTS 5
31,1 		! PumpBHE:Outlet fluid temperature ->Inlet fluid temperature
31,2 		! PumpBHE:Outlet flow rate ->Inlet flowrate (total)
t_ground		! [equation] Temperature on top of storage
t_ground		! [equation] Air temperature
0,0		! [unconnected] Circulation switch
*** INITIAL INPUT VALUES
t_ground 0.0 t_ground t_ground 1 
*------------------------------------------------------------------------------

* Model "Pipe_BHE" (Type 31)
* 

UNIT 23 TYPE 31	 Pipe_BHE
*$UNIT_NAME Pipe_BHE
*$MODEL .\Hydronics\Pipe_Duct\Type31.tmf
*$POSITION 707 857
*$LAYER Main # 
PARAMETERS 6
di_hdpe		! 1 Inside diameter
length_hdpe		! 2 Pipe length
0		! 3 Loss coefficient
rho_src		! 4 Fluid density
cp_src		! 5 Fluid specific heat
t_ground		! 6 Initial fluid temperature
INPUTS 3
22,1 		! BHE:Outlet temperature ->Inlet temperature
22,2 		! BHE:Outlet flow rate (total) ->Inlet flow rate
0,0		! [unconnected] Environment temperature
*** INITIAL INPUT VALUES
t_ground 0 10.0 
*------------------------------------------------------------------------------

* Model "Pipe_HP" (Type 31)
* 

UNIT 57 TYPE 31	 Pipe_HP
*$UNIT_NAME Pipe_HP
*$MODEL .\Hydronics\Pipe_Duct\Type31.tmf
*$POSITION 291 713
*$LAYER Main # 
PARAMETERS 6
di_hppipe		! 1 Inside diameter
length_hppipe		! 2 Pipe length
0		! 3 Loss coefficient
rho_src		! 4 Fluid density
cp_src		! 5 Fluid specific heat
10.0		! 6 Initial fluid temperature
INPUTS 3
28,1 		! TO_HP:Outlet temperature ->Inlet temperature
28,2 		! TO_HP:Outlet flow rate ->Inlet flow rate
0,0		! [unconnected] Environment temperature
*** INITIAL INPUT VALUES
10.0 0 10.0 
*------------------------------------------------------------------------------

* Model "PumpHWfree" (Type 743)
* 

UNIT 75 TYPE 743	 PumpHWfree
*$UNIT_NAME PumpHWfree
*$MODEL .\Hydronics Library (TESS)\Pumps\Input the Flow Rate\Variable-Speed\Power from Polynomial Relationship\Type743.tmf
*$POSITION 169 276
*$LAYER Main # 
*$# PUMP - INLET FLOW RATE KNOWN - POWER COEFFICIENTS
PARAMETERS 8
m_pumpHWmax		! 1 Rated flow rate
cp_hw		! 2 Fluid specific heat
p_pumpHWmax		! 3 Rated power
0.0		! 4 Motor heat loss fraction
3		! 5 Number of power coefficients
0		! 6 Power coefficient-1
0.9		! 7 Power coefficient-2
0.1		! 8 Power coefficient-3
INPUTS 4
7,1 		! Mix_HWS:Outlet temperature ->Inlet fluid temperature
7,2 		! Mix_HWS:Outlet flow rate ->Inlet fluid flow rate
effHPpump		! [equation] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
10 0.0 effHPpump 0.95 
*------------------------------------------------------------------------------

* Model "PumpCHWfree" (Type 743)
* 

UNIT 76 TYPE 743	 PumpCHWfree
*$UNIT_NAME PumpCHWfree
*$MODEL .\Hydronics Library (TESS)\Pumps\Input the Flow Rate\Variable-Speed\Power from Polynomial Relationship\Type743.tmf
*$POSITION 169 394
*$LAYER Main # 
*$# PUMP - INLET FLOW RATE KNOWN - POWER COEFFICIENTS
PARAMETERS 8
m_pumpCHWmax		! 1 Rated flow rate
cp_chw		! 2 Fluid specific heat
p_pumpCHWmax		! 3 Rated power
0.0		! 4 Motor heat loss fraction
3		! 5 Number of power coefficients
0		! 6 Power coefficient-1
0.9		! 7 Power coefficient-2
0.1		! 8 Power coefficient-3
INPUTS 4
8,1 		! Mix_CHWS:Outlet temperature ->Inlet fluid temperature
8,2 		! Mix_CHWS:Outlet flow rate ->Inlet fluid flow rate
effHPpump		! [equation] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
10 0.0 effHPpump 0.95 
*------------------------------------------------------------------------------

* Model "PumpSRCfree" (Type 743)
* 

UNIT 77 TYPE 743	 PumpSRCfree
*$UNIT_NAME PumpSRCfree
*$MODEL .\Hydronics Library (TESS)\Pumps\Input the Flow Rate\Variable-Speed\Power from Polynomial Relationship\Type743.tmf
*$POSITION 169 500
*$LAYER Main # 
*$# PUMP - INLET FLOW RATE KNOWN - POWER COEFFICIENTS
PARAMETERS 8
m_pumpSRCmax		! 1 Rated flow rate
cp_src		! 2 Fluid specific heat
p_pumpSRCmax		! 3 Rated power
0.0		! 4 Motor heat loss fraction
3		! 5 Number of power coefficients
0		! 6 Power coefficient-1
0.9		! 7 Power coefficient-2
0.1		! 8 Power coefficient-3
INPUTS 4
9,1 		! Mix_GHX:Outlet temperature ->Inlet fluid temperature
9,2 		! Mix_GHX:Outlet flow rate ->Inlet fluid flow rate
effHPpump		! [equation] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
10 0.0 effHPpump 0.95 
*------------------------------------------------------------------------------

* EQUATIONS "PowerSum"
* 
EQUATIONS 13
sig_free_any = max(freecool, freeheat)
p_HWpump = [55,3] * (1 - freeheat) + [75,3] * freeheat
p_CHWpump = [54,3] * (1 - freecool) + [76,3] * freecool
p_SRCpump = [56,3] * (1 - sig_free_any) + [77,3] * sig_free_any
p_pumps = p_HWpump + p_CHWpump + p_SRCpump + [31,3] + [24,3] + [25,3]
p_hp = [46,7] + [35,7] + [2,7] + [48,7] + [38,7] + [51,7]
p_elect_total = p_pumps + p_hp + [58,3]
p_gas_total = [11,3]
cop_system = (q_heat + q_cool) / max(p_elect_total + p_gas_total, 1)
p_hp_hc = [46,7] + [35,7] + [2,7] + [48,7]  ! power of just the heating and cooling heat pumps, including none of the DHR power
p_hp_dhr = [38,7] + [51,7]   ! power of just the DHR heat pumps
qsrc_hpdr = - [38,6] - [51,6]
qload_hpdr = [38,5] + [51,5]
*$UNIT_NAME PowerSum
*$LAYER Main
*$POSITION 341 394

*------------------------------------------------------------------------------


* Model "Plot1" (Type 65)
* 

UNIT 72 TYPE 65	 Plot1
*$UNIT_NAME Plot1
*$MODEL .\Output\Online Plotter\Online Plotter Without File\Type65d.tmf
*$POSITION 572 116
*$LAYER Main # 
PARAMETERS 12
10		! 1 Nb. of left-axis variables
10		! 2 Nb. of right-axis variables
-20		! 3 Left axis minimum
60		! 4 Left axis maximum
-20		! 5 Right axis minimum
60		! 6 Right axis maximum
plotspersim		! 7 Number of plots per simulation
12		! 8 X-axis gridpoints
0		! 9 Shut off Online w/o removing
-1		! 10 Logical unit for output file
0		! 11 Output file units
0		! 12 Output file delimiter
INPUTS 20
57,1 		! Pipe_HP:Outlet temperature ->Left axis variable-1
86,3 		! ToaReset:Setpoint temperature for control-2 ->Left axis variable-2
21,18 		! Tank_CHW:Tank nodal temperature-1 ->Left axis variable-3
21,19 		! Tank_CHW:Tank nodal temperature-2 ->Left axis variable-4
21,20 		! Tank_CHW:Tank nodal temperature-3 ->Left axis variable-5
0,0		! [unconnected] Left axis variable-6
0,0		! [unconnected] Left axis variable-7
25,1 		! PumpCHWload:Outlet fluid temperature ->Left axis variable-8
58,1 		! Chiller:Outlet fluid temperature ->Left axis variable-9
19,1 		! LoadCHW:Outlet temperature ->Left axis variable-10
86,1 		! ToaReset:Setpoint temperature for control-1 ->Right axis variable-1
20,18 		! Tank_HW:Tank nodal temperature-1 ->Right axis variable-2
20,19 		! Tank_HW:Tank nodal temperature-2 ->Right axis variable-3
20,20 		! Tank_HW:Tank nodal temperature-3 ->Right axis variable-4
0,0		! [unconnected] Right axis variable-5
0,0		! [unconnected] Right axis variable-6
24,1 		! PumpHWload:Outlet fluid temperature ->Right axis variable-7
11,1 		! Boiler:Outlet fluid temperature ->Right axis variable-8
18,1 		! LoadHW:Outlet temperature ->Right axis variable-9
31,1 		! PumpBHE:Outlet fluid temperature ->Right axis variable-10
*** INITIAL INPUT VALUES
Thpsupply Tchwset Tchwtank1 Tchwtank2 Tchwtank3 label label Tchwloadpump
Tchws Tchwr Thwset Thwtank1 Thwtank2 Thwtank3 label label Thwloadpump
Thws Thwr Tgxin 
LABELS  3
"Temperatures"
"Temperatures"
"Temps1"
*------------------------------------------------------------------------------

* Model "Plot2" (Type 65)
* 

UNIT 73 TYPE 65	 Plot2
*$UNIT_NAME Plot2
*$MODEL .\Output\Online Plotter\Online Plotter Without File\Type65d.tmf
*$POSITION 572 202
*$LAYER Main # 
PARAMETERS 12
10		! 1 Nb. of left-axis variables
10		! 2 Nb. of right-axis variables
-3		! 3 Left axis minimum
12		! 4 Left axis maximum
-3		! 5 Right axis minimum
12		! 6 Right axis maximum
plotspersim		! 7 Number of plots per simulation
12		! 8 X-axis gridpoints
0		! 9 Shut off Online w/o removing
-1		! 10 Logical unit for output file
0		! 11 Output file units
0		! 12 Output file delimiter
INPUTS 20
mods_heat		! CalcHPctrl:mods_heat ->Left axis variable-1
mods_cool		! CalcHPctrl:mods_cool ->Left axis variable-2
limit_heat		! CalcHPctrl:limit_heat ->Left axis variable-3
limit_cool		! CalcHPctrl:limit_cool ->Left axis variable-4
round_ndhr		! CalcHPctrl:round_ndhr ->Left axis variable-5
remain_heat		! CalcHPctrl:remain_heat ->Left axis variable-6
remain_cool		! CalcHPctrl:remain_cool ->Left axis variable-7
sig_correct_hw		! CalcHPctrl:sig_correct_hw ->Left axis variable-8
sig_correct_chw		! CalcHPctrl:sig_correct_chw ->Left axis variable-9
n_modules		! CalcFlow:n_modules ->Left axis variable-10
sig_phwload		! CalcHPctrl:sig_phwload ->Right axis variable-1
sig_pchwload		! CalcHPctrl:sig_pchwload ->Right axis variable-2
freeheat		! CalcHPctrl:freeheat ->Right axis variable-3
freecool		! CalcHPctrl:freecool ->Right axis variable-4
n_bhe		! CalcBHE:n_bhe ->Right axis variable-5
cop_system		! PowerSum:cop_system ->Right axis variable-6
0,0		! [unconnected] Right axis variable-7
0,0		! [unconnected] Right axis variable-8
0,0		! [unconnected] Right axis variable-9
0,0		! [unconnected] Right axis variable-10
*** INITIAL INPUT VALUES
mods_heat mods_cool limit_heat limit_cool round_ndhr remain_heat remain_cool
sig_correct_hw sig_correct_chw n_modules sig_phwload sig_pchwload
freeheat freecool n_bhe cop_system label label label label 
LABELS  3
"Signals"
"Signals"
"Signals"
*------------------------------------------------------------------------------

* Model "Plot3" (Type 65)
* 

UNIT 83 TYPE 65	 Plot3
*$UNIT_NAME Plot3
*$MODEL .\Output\Online Plotter\Online Plotter Without File\Type65d.tmf
*$POSITION 572 298
*$LAYER Main # 
PARAMETERS 12
10		! 1 Nb. of left-axis variables
10		! 2 Nb. of right-axis variables
0		! 3 Left axis minimum
300000		! 4 Left axis maximum
0		! 5 Right axis minimum
300000		! 6 Right axis maximum
plotspersim		! 7 Number of plots per simulation
12		! 8 X-axis gridpoints
0		! 9 Shut off Online w/o removing
-1		! 10 Logical unit for output file
0		! 11 Output file units
0		! 12 Output file delimiter
INPUTS 20
m_chwmax		! CalcFlow:m_chwmax ->Left axis variable-1
m_hwmax		! CalcFlow:m_hwmax ->Left axis variable-2
m_loadcool		! CalcFlow:m_loadcool ->Left axis variable-3
m_loadheat		! CalcFlow:m_loadheat ->Left axis variable-4
m_source		! CalcFlow:m_source ->Left axis variable-5
m_chw		! CalcHPctrl:m_chw ->Left axis variable-6
m_hw		! CalcHPctrl:m_hw ->Left axis variable-7
25,2 		! PumpCHWload:Outlet flow rate ->Left axis variable-8
24,2 		! PumpHWload:Outlet flow rate ->Left axis variable-9
56,2 		! PumpSRC:Outlet flow rate ->Left axis variable-10
31,2 		! PumpBHE:Outlet flow rate ->Right axis variable-1
m_bhemax		! CtrlBHEpump:m_bhemax ->Right axis variable-2
0,0		! [unconnected] Right axis variable-3
0,0		! [unconnected] Right axis variable-4
0,0		! [unconnected] Right axis variable-5
0,0		! [unconnected] Right axis variable-6
0,0		! [unconnected] Right axis variable-7
0,0		! [unconnected] Right axis variable-8
0,0		! [unconnected] Right axis variable-9
0,0		! [unconnected] Right axis variable-10
*** INITIAL INPUT VALUES
m_chwmax m_hwmax m_loadcool m_loadheat m_source m_chw_calc m_hw_calc
m_chw_act m_hw_act m_src_act m_bhe_act m_bhemax label label label label
label label label label 
LABELS  3
"kg/hr"
"kg/hr"
"Flows"
*------------------------------------------------------------------------------

* Model "Plot4" (Type 65)
* 

UNIT 88 TYPE 65	 Plot4
*$UNIT_NAME Plot4
*$MODEL .\Output\Online Plotter\Online Plotter Without File\Type65d.tmf
*$POSITION 572 394
*$LAYER Main # 
PARAMETERS 12
10		! 1 Nb. of left-axis variables
10		! 2 Nb. of right-axis variables
-2000000		! 3 Left axis minimum
2000000		! 4 Left axis maximum
-2000000		! 5 Right axis minimum
2000000		! 6 Right axis maximum
plotspersim		! 7 Number of plots per simulation
12		! 8 X-axis gridpoints
0		! 9 Shut off Online w/o removing
-1		! 10 Logical unit for output file
0		! 11 Output file units
0		! 12 Output file delimiter
INPUTS 20
q_cool		! CalcHPctrl:q_cool ->Left axis variable-1
q_heat_neg		! CalcHPctrl:q_heat_neg ->Left axis variable-2
p_elect_total		! PowerSum:p_elect_total ->Left axis variable-3
p_gas_total		! PowerSum:p_gas_total ->Left axis variable-4
p_HWpump		! PowerSum:p_HWpump ->Left axis variable-5
p_CHWpump		! PowerSum:p_CHWpump ->Left axis variable-6
p_SRCpump		! PowerSum:p_SRCpump ->Left axis variable-7
p_pumps		! PowerSum:p_pumps ->Left axis variable-8
p_hp		! PowerSum:p_hp ->Left axis variable-9
58,3 		! Chiller:Chiller power ->Left axis variable-10
11,3 		! Boiler:Required heating rate ->Right axis variable-1
12,5 		! FreeHeat:Heat transfer rate ->Right axis variable-2
39,5 		! FreeCool:Heat transfer rate ->Right axis variable-3
22,4 		! BHE:Average heat transfer rate ->Right axis variable-4
58,7 		! Chiller:Chiller load met ->Right axis variable-5
qsrc_hpdr		! PowerSum:qsrc_hpdr ->Right axis variable-6
qload_hpdr		! PowerSum:qload_hpdr ->Right axis variable-7
0,0		! [unconnected] Right axis variable-8
0,0		! [unconnected] Right axis variable-9
0,0		! [unconnected] Right axis variable-10
*** INITIAL INPUT VALUES
q_cool q_heat_neg p_elect_total p_gas_total p_HWpump p_CHWpump p_SRCpump
p_pumps p_hp p_Chiller p_boiler q_freeheat q_freecool q_GHX q_Chiller
qsrc_hpdr qload_hpdr label label label 
LABELS  3
"kJ/hr"
"kJ/hr"
"HX"
*------------------------------------------------------------------------------

* Model "Printer" (Type 46)
* 

UNIT 74 TYPE 46	 Printer
*$UNIT_NAME Printer
*$MODEL .\Output\Printegrator\Unformatted\Type46.tmf
*$POSITION 624 525
*$LAYER Main # 
*$# PRINTEGRATOR
PARAMETERS 8
57		! 1 Logical unit
-1		! 2 Logical unit for monthly summaries
0		! 3 Relative or absolute start time
1		! 4 Printing & integrating interval
3		! 5 Number of inputs to avoid integration
15		! 6 Non-integrated input number-1
16		! 7 Non-integrated input number-2
17		! 8 Non-integrated input number-3
INPUTS 17
q_cool		! CalcHPctrl:q_cool ->Input to be integrated & printed-1
q_heat		! CalcHPctrl:q_heat ->Input to be integrated & printed-2
39,5 		! FreeCool:Heat transfer rate ->Input to be integrated & printed-3
12,5 		! FreeHeat:Heat transfer rate ->Input to be integrated & printed-4
p_elect_total		! PowerSum:p_elect_total ->Input to be integrated & printed-5
p_gas_total		! PowerSum:p_gas_total ->Input to be integrated & printed-6
cop_system		! PowerSum:cop_system ->Input to be integrated & printed-7
n_bhe		! CalcBHE:n_bhe ->Input to be integrated & printed-8
p_hp_hc		! PowerSum:p_hp_hc ->Input to be integrated & printed-9
p_hp_dhr		! PowerSum:p_hp_dhr ->Input to be integrated & printed-10
58,3 		! Chiller:Chiller power ->Input to be integrated & printed-11
58,7 		! Chiller:Chiller load met ->Input to be integrated & printed-12
11,5 		! Boiler:Rate of energy delivery to fluid stream ->Input to be integrated & printed-13
22,4 		! BHE:Average heat transfer rate ->Input to be integrated & printed-14
95,3 		! Temp_avgs:Mean value of input-1 ->Input to be integrated & printed-15
95,13 		! Temp_avgs:Mean value of input-2 ->Input to be integrated & printed-16
95,23 		! Temp_avgs:Mean value of input-3 ->Input to be integrated & printed-17
*** INITIAL INPUT VALUES
q_cool q_heat q_freecool q_freeheat p_elect p_fuel cop_system n_bhe
p_hp_hc p_hp_dhr p_chiller q_chiller q_boiler q_GHX_net t_GHX_out t_chw_s
t_hw_s 
LABELS 0

*** External files
ASSIGN "results_hrly.out" 57
*|? Output file for integrated results? |1000
*------------------------------------------------------------------------------

* EQUATIONS "Double click to open."
* 
EQUATIONS 11
Peak_Clg_Bldg_MBH = 10000
Peak_Htg_Bldg_MBH = 10000
GasRate_per_therm = 0.7
ElecRate_per_kWh = 0.1
Peak_CHW_MBH = 1200
Peak_HW_MBH = 900
Hybrid_Percent = 0
Length_GHX = 25000  ! Enter zero to disable geothermal (DHR only)
Ground_Conduct = 1.46
Ground_Temp = 53.5
Ground_Diff = 1.01
*$UNIT_NAME Double click to open.
*$LAYER Main
*$POSITION 78 74

*------------------------------------------------------------------------------


* EQUATIONS "kW_Sum"
* 
EQUATIONS 2
kW_total_for_peak = kW_TRNSYS
kW_TRNSYS = p_elect_total/3600 ! convert kJhr --> kW
*$UNIT_NAME kW_Sum
*$LAYER Main
*$POSITION 344 532

*------------------------------------------------------------------------------


* Model "To Joint Template" (Type 46)
* 

UNIT 90 TYPE 46	 To Joint Template
*$UNIT_NAME To Joint Template
*$MODEL .\Output\Printegrator\Unformatted\Type46.tmf
*$POSITION 581 610
*$LAYER Main # 
*$# PRINTEGRATOR
PARAMETERS 11
60		! 1 Logical unit
-1		! 2 Logical unit for monthly summaries
0		! 3 Relative or absolute start time
8760		! 4 Printing & integrating interval
6		! 5 Number of inputs to avoid integration
1		! 6 Non-integrated input number-1
2		! 7 Non-integrated input number-2
3		! 8 Non-integrated input number-3
4		! 9 Non-integrated input number-4
5		! 10 Non-integrated input number-5
6		! 11 Non-integrated input number-6
INPUTS 6
Peak_Clg_Bldg_MBH		! Double click to open.:Peak_Clg_Bldg_MBH ->Input to be integrated & printed-1
Peak_Htg_Bldg_MBH		! Double click to open.:Peak_Htg_Bldg_MBH ->Input to be integrated & printed-2
92,9 		! kW_PeakCalc:Maximum value of input ->Input to be integrated & printed-3
kWh_total		! Energy_Sum:kWh_total ->Input to be integrated & printed-4
therms_total		! Energy_Sum:therms_total ->Input to be integrated & printed-5
dollars_total		! Energy_Sum:dollars_total ->Input to be integrated & printed-6
*** INITIAL INPUT VALUES
peak_cool_eQ peak_heat_eQ peak_kW kWh_total therms_total dollars_total

LABELS 0

*** External files
ASSIGN "To_Joint_Template.out" 60
*|? Output file for integrated results? |1000
*------------------------------------------------------------------------------

* Model "kW_PeakCalc" (Type 55)
* 

UNIT 92 TYPE 55	 kW_PeakCalc
*$UNIT_NAME kW_PeakCalc
*$MODEL .\Utility\Integrators\Periodic Integrator\Type55.tmf
*$POSITION 452 532
*$LAYER Main # 
PARAMETERS 7
1		! 1 Integrate or sum input
0		! 2 Relative starting hour for input
8760		! 3 Duration for input
8760		! 4 Cycle repeat time for input
8760		! 5 Reset time for input
0		! 6 Absolute starting hour for input
8760		! 7 Absolute stopping hour for input 
INPUTS 1
kW_total_for_peak		! kW_Sum:kW_total_for_peak ->Input
*** INITIAL INPUT VALUES
0. 
*------------------------------------------------------------------------------

* Model "Energy_Int" (Type 55)
* 

UNIT 91 TYPE 55	 Energy_Int
*$UNIT_NAME Energy_Int
*$MODEL .\Utility\Integrators\Periodic Integrator\Type55.tmf
*$POSITION 347 692
*$LAYER Main # 
PARAMETERS 28
1		! 1 Integrate or sum input-1
0		! 2 Relative starting hour for input-1
8760		! 3 Duration for input-1
8760		! 4 Cycle repeat time for input-1
8760		! 5 Reset time for input-1
0		! 6 Absolute starting hour for input-1
8760		! 7 Absolute stopping hour for input -1
1		! 8 Integrate or sum input-2
0		! 9 Relative starting hour for input-2
step		! 10 Duration for input-2
step		! 11 Cycle repeat time for input-2
8760		! 12 Reset time for input-2
0		! 13 Absolute starting hour for input-2
8760		! 14 Absolute stopping hour for input -2
1		! 15 Integrate or sum input-3
0		! 16 Relative starting hour for input-3
step		! 17 Duration for input-3
step		! 18 Cycle repeat time for input-3
8760		! 19 Reset time for input-3
0		! 20 Absolute starting hour for input-3
8760		! 21 Absolute stopping hour for input -3
1		! 22 Integrate or sum input-4
0		! 23 Relative starting hour for input-4
step		! 24 Duration for input-4
step		! 25 Cycle repeat time for input-4
8760		! 26 Reset time for input-4
0		! 27 Absolute starting hour for input-4
8760		! 28 Absolute stopping hour for input -4
INPUTS 4
0,0		! [unconnected] Input-A-1
0,0		! [unconnected] Input-B-2
p_elect_total		! PowerSum:p_elect_total ->Input-C-3
p_gas_total		! PowerSum:p_gas_total ->Input-D-4
*** INITIAL INPUT VALUES
0. 0. 0. 0. 
*------------------------------------------------------------------------------

* EQUATIONS "Energy_Sum"
* 
EQUATIONS 3
kWh_total = [91,1]/3600+[91,21]/3600
therms_total = [91,11]/105506+[91,31]/105506
dollars_total = kWh_total*ElecRate_per_kWh+therms_total*GasRate_per_therm
*$UNIT_NAME Energy_Sum
*$LAYER Main
*$POSITION 460 692

*------------------------------------------------------------------------------


* Model "Type46" (Type 46)
* 

UNIT 94 TYPE 46	 Type46
*$UNIT_NAME Type46
*$MODEL .\Output\Printegrator\Unformatted\Type46.tmf
*$POSITION 442 34
*$LAYER Main # 
*$# PRINTEGRATOR
PARAMETERS 5
61		! 1 Logical unit
-1		! 2 Logical unit for monthly summaries
0		! 3 Relative or absolute start time
1		! 4 Printing & integrating interval
0		! 5 Number of inputs to avoid integration
INPUTS 3
87,2 		! HourlyLoads:Output 2 ->Input to be integrated & printed-1
87,3 		! HourlyLoads:Output 3 ->Input to be integrated & printed-2
87,4 		! HourlyLoads:Output 4 ->Input to be integrated & printed-3
*** INITIAL INPUT VALUES
q_clg q_htg t_oa 
LABELS 0

*** External files
ASSIGN "timecheck.out" 61
*|? Output file for integrated results? |1000
*------------------------------------------------------------------------------

* Model "HourlyLoads" (Type 9)
* 

UNIT 87 TYPE 9	 HourlyLoads
*$UNIT_NAME HourlyLoads
*$MODEL .\Utility\Data Readers\Generic Data Files\Skip Lines to Start\Free Format\Type9c.tmf
*$POSITION 269 79
*$LAYER Weather - Data Files # 
PARAMETERS 26
6		! 1 Mode
1		! 2 Header Lines to Skip
5		! 3 No. of values to read
1.0		! 4 Time interval of data
1		! 5 Interpolate or not-1
1.0		! 6 Multiplication factor-1
0		! 7 Addition factor-1
1		! 8 Average or instantaneous value-1
1		! 9 Interpolate or not-2
1.0550558526		! 10 Multiplication factor-2
0		! 11 Addition factor-2
1		! 12 Average or instantaneous value-2
1		! 13 Interpolate or not-3
1.0550558526		! 14 Multiplication factor-3
0		! 15 Addition factor-3
1		! 16 Average or instantaneous value-3
1		! 17 Interpolate or not-4
0.555556		! 18 Multiplication factor-4
-17.7778		! 19 Addition factor-4
1		! 20 Average or instantaneous value-4
1		! 21 Interpolate or not-5
1.0		! 22 Multiplication factor-5
0		! 23 Addition factor-5
1		! 24 Average or instantaneous value-5
63		! 25 Logical unit for input file
-1		! 26 Free format mode
*** External files
ASSIGN "Loads_SentryHall.txt" 63
*|? Input file name |1000
*------------------------------------------------------------------------------

* Model "Temp_avgs" (Type 55)
* 

UNIT 95 TYPE 55	 Temp_avgs
*$UNIT_NAME Temp_avgs
*$MODEL .\Utility\Integrators\Periodic Integrator\Type55.tmf
*$POSITION 415 447
*$LAYER Main # 
PARAMETERS 21
1		! 1 Integrate or sum input-1
0		! 2 Relative starting hour for input-1
1.0		! 3 Duration for input-1
1		! 4 Cycle repeat time for input-1
1		! 5 Reset time for input-1
0		! 6 Absolute starting hour for input-1
500000		! 7 Absolute stopping hour for input -1
1		! 8 Integrate or sum input-2
0		! 9 Relative starting hour for input-2
1.0		! 10 Duration for input-2
1		! 11 Cycle repeat time for input-2
1		! 12 Reset time for input-2
0		! 13 Absolute starting hour for input-2
500000		! 14 Absolute stopping hour for input -2
1		! 15 Integrate or sum input-3
0		! 16 Relative starting hour for input-3
1.0		! 17 Duration for input-3
1		! 18 Cycle repeat time for input-3
1		! 19 Reset time for input-3
0		! 20 Absolute starting hour for input-3
500000		! 21 Absolute stopping hour for input -3
INPUTS 3
22,1 		! BHE:Outlet temperature ->T_ghx_out
25,1 		! PumpCHWload:Outlet fluid temperature ->T_chw_s
24,1 		! PumpHWload:Outlet fluid temperature ->T_hw_s
*** INITIAL INPUT VALUES
0. 0. 0. 
*------------------------------------------------------------------------------

* Model "Plot5" (Type 65)
* 

UNIT 96 TYPE 65	 Plot5
*$UNIT_NAME Plot5
*$MODEL .\Output\Online Plotter\Online Plotter Without File\Type65d.tmf
*$POSITION 799 321
*$LAYER Main # 
PARAMETERS 12
3		! 1 Nb. of left-axis variables
0		! 2 Nb. of right-axis variables
-20		! 3 Left axis minimum
60		! 4 Left axis maximum
-20		! 5 Right axis minimum
60		! 6 Right axis maximum
plotspersim		! 7 Number of plots per simulation
12		! 8 X-axis gridpoints
0		! 9 Shut off Online w/o removing
-1		! 10 Logical unit for output file
0		! 11 Output file units
0		! 12 Output file delimiter
INPUTS 3
95,3 		! Temp_avgs:Mean value of input-1 ->ground hx leaving T
95,13 		! Temp_avgs:Mean value of input-2 ->chilled water supply T
95,23 		! Temp_avgs:Mean value of input-3 ->hot water supply T
*** INITIAL INPUT VALUES
t_ghx_out t_chw_s t_hw_s 
LABELS  3
"Temperatures"
"Temperatures"
"Temps1"
*------------------------------------------------------------------------------

END
